<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KBO 2025 시즌 진행률 및 순위표 | 한국프로야구 실시간 분석 대시보드</title>
    
    <!-- SEO 메타데이터 -->
    <meta name="description" content="KBO 2025시즌 종합 분석 대시보드. 시즌 진행률, 팀 순위표, 상대전적, 매직넘버, 홈/원정 성적, 클러치 상황 분석 등 한국프로야구의 모든 데이터를 실시간으로 제공합니다.">
    <meta name="keywords" content="KBO, 한국프로야구, 2025시즌, 시즌진행률, 순위표, 상대전적, 매직넘버, 야구통계, 프로야구분석, 홈원정성적, 클러치분석, 팀별소화율">
    <meta name="author" content="KBO 분석 대시보드">
    <link rel="canonical" href="https://sanghunbruceham.github.io/kbo/">
    
    <!-- Open Graph 메타데이터 -->
    <meta property="og:title" content="KBO 2025 종합 분석 대시보드">
    <meta property="og:description" content="한국프로야구 2025시즌의 모든 데이터를 한눈에 분석하고 비교할 수 있는 종합 대시보드. 시즌 진행률, 실시간 순위, 상대전적, 매직넘버 등 제공">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://sanghunbruceham.github.io/kbo/">
    <meta property="og:image" content="https://sanghunbruceham.github.io/kbo/images/kbo-dashboard-preview.png">
    <meta property="og:site_name" content="KBO 분석 대시보드">
    <meta property="og:locale" content="ko_KR">
    
    <!-- Twitter Card 메타데이터 -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="KBO 2025 종합 분석 대시보드">
    <meta name="twitter:description" content="한국프로야구 2025시즌 종합 분석 - 시즌 진행률, 순위표, 상대전적, 매직넘버, 홈원정성적 등">
    <meta name="twitter:image" content="https://sanghunbruceham.github.io/kbo/images/kbo-dashboard-preview.png">
    
    <!-- 파비콘 및 앱 아이콘 -->
    <link rel="icon" type="image/png" sizes="32x32" href="magic-number/icons/kbo-magic-number-icon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="magic-number/icons/kbo-magic-number-icon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="magic-number/icons/kbo-magic-number-icon.png">
    
    <!-- PWA 매니페스트 -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#667eea">
    
    <!-- DNS 프리페치 -->
    <link rel="dns-prefetch" href="//www.googletagmanager.com">
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//pagead2.googlesyndication.com">
    
    <!-- 추가 SEO 최적화 -->
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="googlebot" content="index, follow">
    <meta name="bingbot" content="index, follow">
    <meta name="format-detection" content="telephone=no">
    <meta http-equiv="x-dns-prefetch-control" content="on">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    
    <!-- 성능 최적화 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://www.googletagmanager.com">
    <link rel="preload" href="magic-number/data/enhanced-dashboard.json" as="fetch" crossorigin>
    
    <!-- 지역/언어 설정 -->
    <meta name="geo.region" content="KR">
    <meta name="geo.country" content="KR">
    <meta name="language" content="Korean">
    <link rel="alternate" hreflang="ko" href="https://sanghunbruceham.github.io/kbo/">
    
    <!-- 구조화된 데이터 (JSON-LD) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": ["WebSite", "DataCatalog"],
        "name": "KBO 2025 종합 분석 대시보드",
        "alternateName": "한국프로야구 실시간 분석 대시보드",
        "description": "한국프로야구 2025시즌의 모든 데이터를 한눈에 분석하고 비교할 수 있는 종합 대시보드. 시즌 진행률, 실시간 순위, 상대전적, 매직넘버 등 제공",
        "url": "https://sanghunbruceham.github.io/kbo/",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://sanghunbruceham.github.io/kbo/"
        },
        "author": {
            "@type": "Organization",
            "name": "KBO 분석 대시보드"
        },
        "publisher": {
            "@type": "Organization",
            "name": "KBO 분석 대시보드"
        },
        "inLanguage": "ko-KR",
        "dateCreated": "2025-01-01",
        "dateModified": "2025-08-16",
        "keywords": ["KBO", "한국프로야구", "2025시즌", "시즌진행률", "순위표", "상대전적", "매직넘버", "야구통계", "실시간분석"],
        "about": {
            "@type": "SportsOrganization",
            "name": "한국야구위원회",
            "alternateName": "KBO"
        },
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://sanghunbruceham.github.io/kbo/#{search_term_string}",
            "query-input": "required name=search_term_string"
        },
        "breadcrumb": {
            "@type": "BreadcrumbList",
            "itemListElement": [
                {
                    "@type": "ListItem",
                    "position": 1,
                    "name": "홈",
                    "item": "https://sanghunbruceham.github.io/kbo/"
                },
                {
                    "@type": "ListItem", 
                    "position": 2,
                    "name": "시즌 진행률",
                    "item": "https://sanghunbruceham.github.io/kbo/#season-progress"
                },
                {
                    "@type": "ListItem",
                    "position": 3, 
                    "name": "종합 순위",
                    "item": "https://sanghunbruceham.github.io/kbo/#standings"
                }
            ]
        }
    }
    </script>
    
    <!-- Google Analytics G4A -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TDV2VSSNHN"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-TDV2VSSNHN');
    </script>
    
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5508768187151867" crossorigin="anonymous"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: #f5f7fa;
            color: var(--default-color);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* 분석 테이블 공통 변수 정의 */
        :root {
            /* 색상 변수 */
            --positive-bg-light: linear-gradient(135deg, rgba(34, 197, 94, 0.05) 0%, rgba(22, 163, 74, 0.08) 100%);
            --positive-bg-medium: linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, rgba(22, 163, 74, 0.15) 100%);
            --positive-bg-strong: linear-gradient(135deg, rgba(34, 197, 94, 0.15) 0%, rgba(22, 163, 74, 0.25) 100%);
            --positive-color: #059669;
            
            --negative-bg-light: linear-gradient(135deg, rgba(239, 68, 68, 0.05) 0%, rgba(220, 38, 38, 0.08) 100%);
            --negative-bg-medium: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(220, 38, 38, 0.15) 100%);
            --negative-bg-strong: linear-gradient(135deg, rgba(239, 68, 68, 0.15) 0%, rgba(220, 38, 38, 0.25) 100%);
            --negative-color: #dc2626;
            
            --neutral-bg-light: linear-gradient(135deg, rgba(255, 193, 7, 0.1) 0%, rgba(245, 158, 11, 0.12) 100%);
            --neutral-bg-medium: linear-gradient(135deg, rgba(255, 193, 7, 0.2) 0%, rgba(245, 158, 11, 0.25) 100%);
            --neutral-bg-strong: linear-gradient(135deg, rgba(255, 193, 7, 0.3) 0%, rgba(245, 158, 11, 0.35) 100%);
            --neutral-color: #f59e0b;
            
            /* 추가 강도별 그라데이션 */
            --positive-bg-very-light: linear-gradient(135deg, rgba(34, 197, 94, 0.02) 0%, rgba(22, 163, 74, 0.04) 100%);
            --positive-bg-very-strong: linear-gradient(135deg, rgba(34, 197, 94, 0.25) 0%, rgba(22, 163, 74, 0.35) 100%);
            
            --negative-bg-very-light: linear-gradient(135deg, rgba(239, 68, 68, 0.02) 0%, rgba(220, 38, 38, 0.04) 100%);
            --negative-bg-very-strong: linear-gradient(135deg, rgba(239, 68, 68, 0.25) 0%, rgba(220, 38, 38, 0.35) 100%);
            
            --neutral-bg-very-light: linear-gradient(135deg, rgba(255, 193, 7, 0.05) 0%, rgba(245, 158, 11, 0.08) 100%);
            --neutral-bg-very-strong: linear-gradient(135deg, rgba(255, 193, 7, 0.4) 0%, rgba(245, 158, 11, 0.45) 100%);
            
            --default-bg: #f8f9fa;
            --default-color: #666;
            
            /* 표준화된 폰트 사이즈 */
            --font-2xs: 0.7rem;    /* 매우 작은 보조 텍스트 */
            --font-xs: 0.75rem;    /* 작은 보조 텍스트 */
            --font-sm: 0.8rem;     /* 보조 정보 */
            --font-base: 0.85rem;  /* 기본 텍스트 */
            --font-md: 0.9rem;     /* 중간 텍스트 */
            --font-lg: 1rem;       /* 큰 텍스트 */
            --font-xl: 1.2rem;     /* 소제목 */
            --font-2xl: 1.5rem;    /* 중제목 */
            --font-3xl: 2rem;      /* 대제목 */
            --font-4xl: 2.5rem;    /* 메인 제목 */
            
            /* 폰트 패밀리 시스템 */
            --font-family-base: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            --font-family-mono: 'Consolas', 'Monaco', 'Courier New', monospace;
            
            /* 폰트 굵기 시스템 */
            --font-weight-light: 300;
            --font-weight-normal: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 600;
            --font-weight-bold: 700;
            
            /* 숫자/데이터 표시용 통합 스타일 */
            --data-font-family: var(--font-family-base);
            --data-font-weight: var(--font-weight-semibold);
            --data-font-size: var(--font-base);
            
            /* 승률 표시용 통합 스타일 (일반 폰트로 통일) */
            --winrate-font-family: var(--font-family-base);
            --winrate-font-weight: var(--font-weight-semibold);
            --winrate-font-size: var(--font-base);
            
            /* 카드 공통 스타일 변수 */
            --card-width: calc(100% - 20px);
            --card-max-width: 1400px;
            --card-padding: 25px;
            --card-margin: 0 auto 25px auto;
            --card-border-radius: 15px;
            --card-background: rgba(255, 255, 255, 0.95);
            --card-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            --card-backdrop-filter: blur(10px);
        }

        .container {
            max-width: var(--card-max-width);
            margin: 0 auto;
            padding: 20px;
            width: 100%;
            box-sizing: border-box;
        }

        .header {
            background: linear-gradient(135deg, #1a237e 0%, #3949ab 100%);
            color: #ffffff;
            padding: 40px 20px;
            margin: 0 0 30px 0;
            width: 100%;
            text-align: center;
            box-sizing: border-box;
            box-shadow: 0 4px 8px rgba(0,0,0,0.12);
        }

        .header-content {
            max-width: 1600px;
            margin: 0 auto;
            padding: 0;
        }

        .header h1 {
            font-size: var(--font-4xl);
            color: #ffffff;
            margin-bottom: 10px;
            font-weight: var(--font-weight-bold);
        }

        .header .subtitle {
            font-size: var(--font-xl);
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 20px;
        }

        .update-info {
            display: inline-block;
            background: rgba(255, 255, 255, 0.15);
            color: #ffffff;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: var(--font-md);
            font-weight: var(--font-weight-medium);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .full-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(800px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .wide-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .card {
            background: var(--card-background);
            border-radius: var(--card-border-radius);
            padding: var(--card-padding);
            box-shadow: var(--card-shadow);
            backdrop-filter: var(--card-backdrop-filter);
            margin: var(--card-margin);
            width: var(--card-width) !important;
            max-width: var(--card-max-width) !important;
            min-width: 0 !important;
            box-sizing: border-box;
            overflow: visible; /* 모든 콘텐츠 표시 */
        }

        /* 광고 카드 전용 클래스 - card 스타일 상속 */
        .ad-card {
            background: var(--card-background);
            border-radius: var(--card-border-radius);
            padding: var(--card-padding);
            box-shadow: var(--card-shadow);
            backdrop-filter: var(--card-backdrop-filter);
            margin: var(--card-margin);
            width: var(--card-width) !important;
            max-width: var(--card-max-width) !important;
            min-width: 0 !important;
            box-sizing: border-box;
            text-align: center;
        }

        /* 개선 제안 카드 전용 스타일 */
        .improvement-suggestion-content {
            text-align: center;
            padding: 20px 0;
        }

        .improvement-suggestion-text {
            font-size: var(--font-base);
            margin: 0 0 20px 0;
            color: #6c757d;
            line-height: 1.6;
        }

        .improvement-suggestion-subtext {
            font-size: var(--font-sm);
            opacity: 0.8;
        }

        .improvement-suggestion-btn {
            display: inline-block;
            color: white;
            text-decoration: none;
            font-size: var(--font-base);
            padding: 14px 28px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            transition: all 0.3s ease;
            font-weight: var(--font-weight-semibold);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            border: none;
            cursor: pointer;
        }

        .improvement-suggestion-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #ecf0f1;
        }

        .card-icon {
            font-size: var(--font-3xl);
            margin-right: 15px;
        }

        .card-title {
            font-size: var(--font-2xl);
            font-weight: var(--font-weight-semibold);
            color: #2c3e50;
        }

        /* 전체 순위표 - 가로 스크롤 */
        .full-standings-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 0;
            font-size: var(--font-base);
        }

        .full-standings-table th,
        .full-standings-table td {
            padding: 10px 6px;
            text-align: center;
            border: 1px solid #d1d5db;
            white-space: nowrap;
        }
        
        .full-standings-table th {
            border: 1px solid #d1d5db;
        }

        .full-standings-table th {
            background: #34495e;
            color: white;
            font-weight: var(--font-weight-semibold);
            font-size: var(--font-base);
            font-family: var(--font-family-base);
        }

        .full-standings-table .team-name {
            text-align: center !important;
            font-weight: var(--font-weight-semibold);
            min-width: 60px;
        }

        .full-standings-table .rank-1 { background: #fff3cd; }
        .full-standings-table .rank-2 { background: #f8f9fa; }
        .full-standings-table .rank-3 { background: #f8f9fa; }

        /* 지표 그리드 */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .metric-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            border-left: 4px solid #3498db;
        }

        .metric-card.positive {
            border-left-color: #27ae60;
            background: #f0f9f4;
        }

        .metric-card.negative {
            border-left-color: #e74c3c;
            background: #fdf2f2;
        }

        .metric-card.neutral {
            border-left-color: #d97706;
            background: #fffbf0;
        }

        .metric-value {
            font-size: var(--font-2xl);
            font-weight: var(--font-weight-bold);
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: var(--font-sm);
            color: #7f8c8d;
            font-weight: var(--font-weight-medium);
        }

        .metric-team {
            font-size: var(--font-md);
            font-weight: var(--font-weight-semibold);
            color: #2980b9;
            margin-bottom: 5px;
        }

        /* 상세 테이블 */
        .detail-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 0;
            font-size: var(--font-base);
        }

        .detail-table th,
        .detail-table td {
            padding: 8px 6px;
            text-align: center;
            border: 1px solid #d1d5db;
        }

        .detail-table th {
            background: #34495e;
            color: white;
            font-weight: var(--font-weight-semibold);
            font-size: var(--font-base);
            font-family: var(--font-family-base);
            cursor: pointer;
            transition: background 0.2s ease;
            user-select: none;
            position: relative;
        }
        
        .detail-table th:hover {
            background: #2c3e50;
        }
        
        .detail-table th.sortable::after {
            content: '';
        }
        
        .detail-table th.sort-asc::after {
            content: '';
        }
        
        .detail-table th.sort-desc::after {
            content: '';
        }

        .detail-table .team-name {
            text-align: center !important;
            font-weight: var(--font-weight-semibold);
        }

        /* 순위 열 스타일 */
        .detail-table th:first-child {
            width: 50px;
            min-width: 50px;
            max-width: 50px;
        }
        
        /* 순위 셀 통일된 스타일 */
        .detail-table td:first-child,
        .full-standings-table td:first-child {
            font-size: var(--font-base) !important;
            font-weight: var(--font-weight-bold);
            text-align: center;
        }
        
        .detail-table td:first-child {
            width: 50px;
            min-width: 50px;
            max-width: 50px;
            font-weight: var(--font-weight-bold);
            text-align: center;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            color: #495057;
        }

        /* 순위별 특별 표시 */
        .rank-1 { 
            background: linear-gradient(135deg, #ffd700, #ffed4e) !important; 
            color: #8b5a00 !important; 
            font-size: var(--font-base) !important;
            font-weight: var(--font-weight-bold) !important;
        }
        .rank-2 { 
            background: linear-gradient(135deg, #c0c0c0, #e8e8e8) !important; 
            color: #666666 !important; 
            font-size: var(--font-base) !important;
            font-weight: var(--font-weight-bold) !important;
        }
        .rank-3 { 
            background: linear-gradient(135deg, #cd7f32, #daa557) !important; 
            color: #5d3a0a !important; 
            font-size: var(--font-base) !important;
            font-weight: var(--font-weight-bold) !important;
        }
        
        .rank-other {
            font-size: var(--font-base) !important;
            font-weight: var(--font-weight-semibold) !important;
        }

        .positive { color: #059669; font-weight: var(--font-weight-semibold); }
        .negative { color: #dc2626; font-weight: var(--font-weight-semibold); }
        .neutral { color: #d97706; font-weight: var(--font-weight-semibold); }
        
        /* 승-패-승률 셀 스타일 개선 */
        .record-cell {
            text-align: center;
            padding: 8px 4px;
            font-size: var(--font-base);
            line-height: 1.3;
            border-radius: 4px;
            transition: all 0.2s ease;
        }
        
        .record-cell:hover {
            transform: scale(1.02);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .record-cell .record {
            font-family: var(--data-font-family);
            font-weight: var(--font-weight-bold);
            font-size: var(--font-md);
            margin-bottom: 2px;
            display: block;
        }
        
        .record-cell .rate {
            font-family: var(--winrate-font-family);
            font-size: var(--font-sm);
            font-weight: var(--winrate-font-weight);
            opacity: 0.9;
            display: block;
            padding: 1px 4px;
            border-radius: 8px;
            background: rgba(255,255,255,0.7);
        }
        
        .record-cell .games {
            font-size: var(--font-2xs);
            color: #666;
            margin-top: 2px;
            display: block;
            opacity: 0.8;
        }

        /* 매트릭스 테이블 */
        .matrix-table {
            width: 100%;
            border-collapse: collapse;
            font-size: var(--font-base);
            margin-top: 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .matrix-table th,
        .matrix-table td {
            padding: 10px 8px;
            text-align: center;
            border: 1px solid #d1d5db;
            position: relative;
            min-width: 90px;
            width: 90px;
            max-width: 90px;
        }

        .matrix-table th {
            background: #34495e;
            color: white;
            font-weight: var(--font-weight-semibold);
            font-size: var(--font-base);
            font-family: var(--font-family-base);
            padding: 12px 8px;
            text-align: center;
        }

        .matrix-table td {
            background: white;
            transition: background-color 0.2s ease;
        }

        .matrix-table td:hover {
            background-color: #f8f9fa;
            transform: scale(1.02);
        }

        .matrix-record {
            font-family: var(--data-font-family);
            font-weight: var(--data-font-weight);
            font-size: var(--font-md);
            display: block;
            margin-bottom: 2px;
        }
        
        .matrix-cell-detailed {
            text-align: center;
            font-size: var(--font-base);
        }
        
        .matrix-details {
            margin-top: 4px;
            padding-top: 4px;
            border-top: 1px solid #eee;
        }
        
        .home-away-split {
            display: flex;
            justify-content: space-between;
            gap: 4px;
        }
        
        .home-record, .away-record {
            font-size: var(--font-xs);
            padding: 1px 3px;
            border-radius: 3px;
            background: #f8f9fa;
            color: #666;
        }
        
        .home-record:hover, .away-record:hover {
            background: #e9ecef;
            color: #333;
        }

        .matrix-rate {
            font-family: var(--winrate-font-family);
            font-size: var(--font-xs);
            font-weight: var(--winrate-font-weight);
            opacity: 0.8;
        }

        /* 월별/요일별 그리드 */
        .performance-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        
        @media (max-width: 1400px) {
            .performance-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 900px) {
            .performance-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 600px) {
            .performance-grid {
                grid-template-columns: 1fr;
            }
        }

        .performance-item {
            background: white;
            border-radius: 15px;
        }
        
        .stadium-analysis-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 1px solid #e1e8ed;
        }
        
        .stadium-team-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f8f9fa;
        }
        
        .team-rank {
            background: #3498db;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: var(--font-base);
            font-weight: var(--font-weight-semibold);
            margin-right: 10px;
        }
        
        .team-name-large {
            font-size: var(--font-xl);
            font-weight: var(--font-weight-bold);
            color: #2c3e50;
        }

        .team-logo {
            width: 24px;
            height: 24px;
            margin-right: 8px;
            vertical-align: middle;
            border-radius: 3px;
        }

        .team-logo-small {
            width: 18px;
            height: 18px;
            margin-right: 5px;
            vertical-align: middle;
            border-radius: 2px;
        }
        
        #monthlyTable .team-logo-small {
            width: 16px;
            height: 16px;
            margin-right: 3px;
        }

        .team-name-with-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .matrix-table .team-name-with-logo {
            gap: 3px;
            font-size: var(--font-base);
        }

        .weekly-table .team-name-with-logo, 
        .all-teams-table .team-name-with-logo {
            gap: 6px;
        }

        /* 월별 테이블 스타일 개선 */
        #monthlyTable {
            border-collapse: collapse;
            font-size: var(--font-sm);
            width: 100%;
        }

        #monthlyTable th,
        #monthlyTable td {
            border: 1px solid #d1d5db;
            padding: 10px 8px;
            text-align: center;
        }
        
        #monthlyTable .stats-row {
            border-top: 2px solid #d1d5db;
        }
        
        #monthlyTable .stats-row:first-of-type {
            border-top: 3px solid #6b7280;
        }

        #monthlyTable th {
            background: #34495e;
            color: white;
            font-weight: var(--font-weight-semibold);
            font-size: var(--font-base);
            font-family: var(--font-family-base);
            white-space: nowrap;
        }


        #monthlyTable .team-name-with-logo {
            gap: 2px;
            font-size: var(--font-xs);
            white-space: nowrap;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        #monthlyTable th {
            white-space: nowrap;
            vertical-align: middle;
        }

        /* 월별 테이블 통계 행들 스타일 */
        #monthlyTable .stats-row {
            border-top: 2px solid #34495e;
        }

        #monthlyTable .stats-row td {
            border-color: #d1d5db;
            font-weight: var(--font-weight-medium);
            padding: 10px 8px;
            font-size: var(--font-base);
            text-align: center;
        }

        /* 월별 테이블 라벨 셀 (월, 통계 라벨) */
        #monthlyTable .month-label,
        #monthlyTable .stats-label {
            font-weight: var(--font-weight-semibold);
            color: white;
            padding: 10px 8px;
            text-align: center;
        }

        #monthlyTable .month-label {
            background: #f8f9fa;
            color: #2d3748;
            font-size: var(--font-md);
            padding: 8px 6px;
        }

        #monthlyTable .stats-label {
            font-size: var(--font-base);
            padding: 8px 6px;
        }

        /* 월별 테이블 데이터 셀 */
        #monthlyTable .month-data {
            font-size: var(--font-base);
            line-height: 1.3;
            padding: 8px 6px;
            text-align: center;
            color: #2d3748;
        }
        
        /* 월별/요일별 기록 셀 */
        .month-record-cell, .month-rate-cell {
            color: #2d3748 !important;
            font-weight: var(--font-weight-semibold);
        }

        #monthlyTable .month-data .record {
            margin-bottom: 2px;
        }

        #monthlyTable .month-data .rate {
            font-family: var(--winrate-font-family);
            font-weight: var(--winrate-font-weight);
            font-size: var(--font-base);
        }
        
        /* 새로운 분리된 셀 스타일 */
        #monthlyTable .month-record-cell {
            font-size: var(--font-base);
            font-weight: var(--font-weight-semibold);
            text-align: center;
            padding: 8px 4px;
            /* 배경색을 JavaScript에서 동적으로 설정 */
            line-height: 1.3;
        }
        
        #monthlyTable .month-rate-cell {
            font-family: var(--winrate-font-family);
            font-size: var(--font-md);
            font-weight: var(--font-weight-bold);
            text-align: center;
            padding: 8px 4px;
            line-height: 1.3;
        }

        /* 요일별 테이블 스타일 개선 */
        #weekdayTable td {
            color: #2d3748 !important;
        }
        
        /* 월별/요일별 테이블에 주차별과 동일한 색상 클래스 적용 */
        #monthlyTable .positive, #weekdayTable .positive {
            background: var(--positive-bg-medium) !important;
            color: var(--positive-color) !important;
            font-weight: var(--font-weight-semibold);
        }
        
        #monthlyTable .negative, #weekdayTable .negative {
            background: var(--negative-bg-medium) !important;
            color: var(--negative-color) !important;
            font-weight: var(--font-weight-semibold);
        }
        
        #monthlyTable .neutral, #weekdayTable .neutral {
            background: var(--neutral-bg-light) !important;
            color: var(--neutral-color) !important;
            font-weight: var(--font-weight-medium);
        }
        #weekdayTable th,
        #weekdayTable td {
            padding: 8px 6px;
            text-align: center;
            vertical-align: middle;
        }

        /* 주말승률과 평일승률 열 구분선 제거 */
        #weekdayTable th:nth-child(10), /* 주말승률 헤더 */
        #weekdayTable td:nth-child(10) { /* 주말승률 데이터 */
            position: relative;
        }


        /* 주말승률과 평일승률 헤더 배경 강조 */
        #weekdayTable th:nth-child(10),
        #weekdayTable th:nth-child(11) {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            font-weight: var(--font-weight-bold);
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }

        /* 요일별 분석 색상 정의 */
        #weekdayTable .positive {
            background: var(--positive-bg-medium);
            color: var(--positive-color);
            font-weight: var(--font-weight-semibold);
        }

        #weekdayTable .negative {
            background: var(--negative-bg-medium);
            color: var(--negative-color);
            font-weight: var(--font-weight-semibold);
        }

        #weekdayTable .neutral {
            background: var(--neutral-bg-light);
            color: var(--neutral-color);
            font-weight: var(--font-weight-medium);
        }

        /* 주차별 분석 색상 정의 (요일별과 동일) */
        .weekly-table .positive {
            background: var(--positive-bg-medium);
            color: var(--positive-color);
            font-weight: var(--font-weight-semibold);
        }

        .weekly-table .negative {
            background: var(--negative-bg-medium);
            color: var(--negative-color);
            font-weight: var(--font-weight-semibold);
        }

        .weekly-table .neutral {
            background: var(--neutral-bg-light);
            color: var(--neutral-color);
            font-weight: var(--font-weight-medium);
        }

        /* 추가 강도별 색상 클래스 */
        .positive-very-light { 
            background: var(--positive-bg-very-light) !important; 
            color: var(--positive-color) !important; 
            font-weight: var(--font-weight-medium);
        }
        .positive-light { 
            background: var(--positive-bg-light) !important; 
            color: var(--positive-color) !important; 
            font-weight: var(--font-weight-medium);
        }
        .positive-medium { 
            background: var(--positive-bg-medium) !important; 
            color: var(--positive-color) !important; 
            font-weight: var(--font-weight-semibold);
        }
        .positive-strong { 
            background: var(--positive-bg-strong) !important; 
            color: var(--positive-color) !important; 
            font-weight: var(--font-weight-semibold);
        }
        .positive-very-strong { 
            background: var(--positive-bg-very-strong) !important; 
            color: var(--positive-color) !important; 
            font-weight: var(--font-weight-bold);
        }

        .negative-very-light { 
            background: var(--negative-bg-very-light) !important; 
            color: var(--negative-color) !important; 
            font-weight: var(--font-weight-medium);
        }
        .negative-light { 
            background: var(--negative-bg-light) !important; 
            color: var(--negative-color) !important; 
            font-weight: var(--font-weight-medium);
        }
        .negative-medium { 
            background: var(--negative-bg-medium) !important; 
            color: var(--negative-color) !important; 
            font-weight: var(--font-weight-semibold);
        }
        .negative-strong { 
            background: var(--negative-bg-strong) !important; 
            color: var(--negative-color) !important; 
            font-weight: var(--font-weight-semibold);
        }
        .negative-very-strong { 
            background: var(--negative-bg-very-strong) !important; 
            color: var(--negative-color) !important; 
            font-weight: var(--font-weight-bold);
        }

        .neutral-very-light { 
            background: var(--neutral-bg-very-light) !important; 
            color: var(--neutral-color) !important; 
            font-weight: var(--font-weight-medium);
        }
        .neutral-light { 
            background: var(--neutral-bg-light) !important; 
            color: var(--neutral-color) !important; 
            font-weight: var(--font-weight-medium);
        }
        .neutral-medium { 
            background: var(--neutral-bg-medium) !important; 
            color: var(--neutral-color) !important; 
            font-weight: var(--font-weight-semibold);
        }
        .neutral-strong { 
            background: var(--neutral-bg-strong) !important; 
            color: var(--neutral-color) !important; 
            font-weight: var(--font-weight-semibold);
        }
        .neutral-very-strong { 
            background: var(--neutral-bg-very-strong) !important; 
            color: var(--neutral-color) !important; 
            font-weight: var(--font-weight-bold);
        }

        /* 분석 테이블 호버 효과 및 전환 애니메이션 */
        #fullStandingsTable td,
        #pythagoreanTable td,
        #clutchTable td,
        #homeAwayTable td,
        #matrixTable td,
        #monthlyTable td,
        #weekdayTable td,
        .weekly-table td {
            transition: all 0.3s ease;
            position: relative;
        }

        #fullStandingsTable td:hover,
        #pythagoreanTable td:hover,
        #clutchTable td:hover,
        #homeAwayTable td:hover,
        #matrixTable td:hover,
        #monthlyTable td:hover,
        #weekdayTable td:hover,
        .weekly-table td:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            z-index: 1;
        }

        /* 월별 테이블 일반 데이터 행 */
        #monthlyTable tbody tr:not(.stats-row) td {
            /* 배경색을 JavaScript에서 동적으로 설정하므로 여기서는 제거 */
        }

        #monthlyTable tbody tr:not(.stats-row):hover td {
            /* 호버 시에도 동적 배경색 유지 */
            filter: brightness(1.05);
        }
        
        .home-away-summary {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .home-summary, .away-summary {
            flex: 1;
            text-align: center;
            padding: 12px;
            border-radius: 10px;
            background: #f8f9fa;
        }
        
        .location-label {
            font-size: var(--font-base);
            font-weight: var(--font-weight-semibold);
            color: #666;
            margin-bottom: 5px;
        }
        
        .record-large {
            font-size: var(--font-xl);
            font-weight: var(--font-weight-bold);
            margin-bottom: 3px;
        }
        
        .rate-large {
            font-size: var(--font-lg);
            font-weight: var(--font-weight-semibold);
            opacity: 0.8;
        }
        
        .stadium-highlights {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .best-stadium, .worst-stadium {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: var(--font-md);
        }
        
        .best-stadium {
            background: #e8f5e8;
            border-left: 4px solid #27ae60;
        }
        
        .worst-stadium {
            background: #fdf2f2;
            border-left: 4px solid #e74c3c;
        }
        
        .highlight-label {
            font-weight: var(--font-weight-semibold);
            min-width: 35px;
        }
        
        .stadium-name {
            font-weight: var(--font-weight-semibold);
            color: #2c3e50;
            min-width: 50px;
        }
        
        .highlight-record {
            font-weight: var(--font-weight-bold);
            margin-left: auto;
        }
            padding: 25px;
            border: 1px solid #e0e0e0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .performance-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
        }

        .performance-team {
            font-size: var(--font-xl);
            font-weight: var(--font-weight-bold);
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 3px solid #3498db;
        }

        .performance-detail {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f8f8f8;
            font-size: var(--font-md);
            line-height: 1.4;
            transition: all 0.2s ease;
        }

        .performance-detail:last-child {
            border-bottom: none;
        }
        
        .performance-detail:hover {
            background-color: #fafafa;
            border-radius: 6px;
            padding: 8px 6px;
        }

        .performance-period {
            font-weight: var(--font-weight-semibold);
            color: #2c3e50;
            min-width: 80px;
            line-height: 1.3;
        }

        .performance-result {
            font-weight: var(--font-weight-semibold);
            text-align: right;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .performance-wins {
            color: #2ecc71;
            font-size: var(--font-lg);
        }

        .performance-losses {
            color: #e67e22;
            font-size: var(--font-lg);
        }

        .performance-rate {
            background: #ecf0f1;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: var(--font-sm);
            font-weight: var(--font-weight-bold);
            margin-left: 6px;
        }

        .table-container {
            overflow-x: auto;
            margin-top: 8px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 100%;
        }

        /* 모바일 반응형 폰트 조정 */
        @media (max-width: 768px) {
            :root {
                --font-2xs: 0.65rem;
                --font-xs: 0.7rem;
                --font-sm: 0.75rem;
                --font-base: 0.8rem;
                --font-md: 0.85rem;
                --font-lg: 0.9rem;
                --font-xl: 1rem;
                --font-2xl: 1.2rem;
                --font-3xl: 1.5rem;
                --font-4xl: 2rem;
            }
            
            .header h1 {
                font-size: var(--font-3xl);
            }
            
            .full-grid {
                grid-template-columns: 1fr;
            }
            
            .metrics-grid {
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            }
            
            .performance-grid {
                grid-template-columns: 1fr;
            }
            
            .detailed-game-table {
                font-size: var(--font-sm);
            }
            
            .detailed-game-table th,
            .detailed-game-table td {
                padding: 8px 4px;
                border-left: none;
                border-right: none;
                font-size: var(--font-sm);
            }
            
            .detailed-game-table tr {
                border-bottom: 1px solid #e2e8f0;
            }
            
            /* 모바일에서 매트릭스 테이블 셀 크기 조정 */
            .matrix-table th,
            .matrix-table td {
                min-width: 70px;
                width: 70px;
                max-width: 70px;
                padding: 8px 4px;
                font-size: var(--font-xs);
            }
            
        }



        .highlight {
            background: linear-gradient(120deg, #a8e6cf 0%, #dcedc8 100%);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: var(--font-weight-semibold);
        }

        /* 통일된 테이블 스타일 - 기존 테이블과 동일한 스타일 적용 */

        .weekly-table, .game-record-table, .all-teams-table, .detailed-game-table {
            width: 100%;
            border-collapse: collapse;
            font-size: var(--font-sm);  /* 폰트 크기 축소 */
            margin-top: 0;
        }

        /* 테이블 스크롤 컨테이너 - 긴 테이블용 */
        .table-scroll-wrapper {
            max-height: 650px;  /* 더 많은 주차를 보여주도록 높이 증가 */
            overflow-y: auto;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            position: relative;
            margin-top: 10px;
        }
        
        /* 게임기록과 팀상세는 더 많은 데이터 표시 */
        .table-scroll-wrapper:has(.all-teams-table),
        .table-scroll-wrapper:has(.detailed-game-table) {
            max-height: 900px; /* 750px에서 900px로 증가 */
        }

        /* 화면 크기별 반응형 높이 조정 - 더 많은 주차 표시 */
        @media (min-width: 1920px) {
            .table-scroll-wrapper {
                max-height: 800px;  /* 대형 모니터에서 더 많은 주차 */
            }
            
            /* 게임기록과 팀상세는 대형 모니터에서 더 높게 */
            .table-scroll-wrapper:has(.all-teams-table),
            .table-scroll-wrapper:has(.detailed-game-table) {
                max-height: 1100px; /* 900px에서 1100px로 증가 */
            }
        }

        @media (max-width: 1366px) {
            .table-scroll-wrapper {
                max-height: 550px;  /* 노트북 화면 */
            }
            
            .table-scroll-wrapper:has(.all-teams-table),
            .table-scroll-wrapper:has(.detailed-game-table) {
                max-height: 800px; /* 650px에서 800px로 증가 */
            }
        }

        @media (max-width: 768px) {
            .table-scroll-wrapper {
                max-height: 450px;  /* 태블릿/모바일 */
            }
            
            .table-scroll-wrapper:has(.all-teams-table),
            .table-scroll-wrapper:has(.detailed-game-table) {
                max-height: 600px; /* 500px에서 600px로 증가 */
            }
        }

        /* 스티키 테이블 헤더 */
        .table-scroll-wrapper .weekly-table thead th,
        .table-scroll-wrapper .game-record-table thead th,
        .table-scroll-wrapper .all-teams-table thead th,
        .table-scroll-wrapper .detailed-game-table thead th {
            position: sticky;
            top: 0;
            background: #34495e;
            color: white;
            z-index: 50;
            box-shadow: 0 2px 4px rgba(0,0,0,0.15);
        }

        /* 주차별 테이블 헤더를 하나의 통합된 스티키 블록으로 처리 */
        .table-scroll-wrapper .weekly-table thead {
            position: sticky;
            top: 0;
            z-index: 100;
            background: #34495e; /* thead 전체 배경 */
            box-shadow: 0 2px 8px rgba(0,0,0,0.2); /* 더 진한 그림자 */
        }
        
        /* 모든 헤더 셀에 통일된 스타일 적용 */
        .table-scroll-wrapper .weekly-table thead th {
            background: #34495e !important;
            color: white !important;
            border: 1px solid #495057;
            position: static; /* 부모의 sticky를 따라감 */
            white-space: nowrap; /* 헤더 텍스트 줄바꿈 방지 */
        }

        .weekly-table th, .weekly-table td,
        .game-record-table th, .game-record-table td,
        .all-teams-table th, .all-teams-table td,
        .detailed-game-table th, .detailed-game-table td {
            border: 1px solid #d1d5db;
            padding: 6px 4px;  /* 패딩 축소 (8px 6px → 6px 4px) */
            text-align: center;
        }

        /* 밀도 높은 테이블 모드 */
        .table-scroll-wrapper.dense-mode .weekly-table td,
        .table-scroll-wrapper.dense-mode .all-teams-table td,
        .table-scroll-wrapper.dense-mode .detailed-game-table td {
            padding: 4px 3px;  /* 더 작은 패딩 옵션 */
            font-size: var(--font-xs);
        }

        /* 테이블 행 높이 최적화 */
        .table-scroll-wrapper tr {
            line-height: 1.3;  /* 라인 높이 감소 */
        }

        /* 게임 기록 테이블 특별 스타일 */
        .all-teams-table td,
        .detailed-game-table td {
            white-space: nowrap;  /* 텍스트 줄바꿈 방지 */
        }

        .weekly-table th, .game-record-table th, .detailed-game-table th {
            background: #34495e;
            color: white;
            font-weight: var(--font-weight-semibold);
            font-size: var(--font-base);
            font-family: var(--font-family-base);
        }
        
        /* 주차별 테이블 기본 헤더 스타일 */
        .weekly-table th {
            font-size: var(--font-base);
            text-align: center;
        }
        
        /* rowspan 헤더 (주차, 기간) */
        .weekly-table th[rowspan="2"] {
            font-size: var(--font-base);
            font-weight: var(--font-weight-bold);
            min-width: 80px;
            vertical-align: middle;
            padding: 16px 8px; /* 2행에 걸쳐 있으므로 더 큰 패딩 */
        }
        
        /* colspan 헤더 (팀별 성적) */
        .weekly-table th[colspan] {
            text-align: center;
            font-weight: var(--font-weight-semibold);
            padding: 8px;
        }
        
        /* 팀명 헤더 */
        .weekly-table .team-header {
            font-size: var(--font-sm);
            font-weight: var(--font-weight-semibold);
            padding: 8px 4px;
            min-width: 70px;
        }

        .team-header, .team-header-column {
            background: #34495e !important;
            color: white !important;
            font-weight: var(--font-weight-bold);
        }

        .week-cell, .game-number-cell, .game-num-cell {
            font-weight: var(--font-weight-bold);
            color: #2c3e50;
            font-size: var(--font-base);
        }

        .date-cell {
            font-size: var(--font-base);
            white-space: nowrap;
            color: #2c3e50;
            padding: 8px 12px;
            text-align: center;
            background: #f8f9fa;
            font-weight: var(--font-weight-medium);
        }

        .team-stats {
            padding: 8px 6px;
        }

        .record {
            font-family: var(--data-font-family);
            font-weight: var(--font-weight-bold);
            font-size: var(--font-md);
            color: #1a202c;
        }

        .win-rate {
            font-family: var(--winrate-font-family);
            font-size: var(--font-sm);
            color: #2d3748;
            margin-top: 3px;
            font-weight: var(--winrate-font-weight);
        }

        /* 승률 표기 통일 스타일 */
        .baseball-winrate {
            font-family: var(--winrate-font-family);
            font-weight: var(--winrate-font-weight);
            font-size: var(--winrate-font-size);
            color: #2d3748;
        }

        .baseball-winrate-cell {
            font-family: var(--winrate-font-family);
            font-weight: var(--font-weight-bold);
            font-size: var(--winrate-font-size);
            text-align: center;
        }

        .baseball-winrate-inline {
            font-family: var(--winrate-font-family);
            font-weight: var(--font-weight-medium);
            font-size: var(--winrate-font-size);
        }

        /* 유틸리티 폰트 클래스 - 재사용성을 위해 */
        .font-data {
            font-family: var(--data-font-family);
            font-weight: var(--data-font-weight);
            font-size: var(--data-font-size);
        }
        
        .font-winrate {
            font-family: var(--winrate-font-family);
            font-weight: var(--winrate-font-weight);
            font-size: var(--winrate-font-size);
        }
        
        .font-data-bold {
            font-family: var(--data-font-family);
            font-weight: var(--font-weight-bold);
            font-size: var(--data-font-size);
        }

        /* 모든 테이블 셀의 기본 폰트 통일 */
        table td {
            font-family: var(--data-font-family);
        }
        
        /* strong 태그 폰트 통일 */
        table strong {
            font-family: var(--data-font-family);
            font-weight: var(--font-weight-bold);
        }
        
        /* 숫자 데이터 표시용 강제 스타일 */
        #fullStandingsTable td,
        #pythagoreanTable td,
        #clutchTable td {
            font-family: var(--data-font-family);
            font-weight: var(--data-font-weight);
        }
        
        #fullStandingsTable strong,
        #pythagoreanTable strong, 
        #clutchTable strong {
            font-family: var(--data-font-family);
            font-weight: var(--font-weight-bold);
        }
        
        /* 승률 표시 컬럼들에 모노스페이스 폰트 적용 */
        #fullStandingsTable td:nth-child(8),  /* 승률 컬럼 */
        #fullStandingsTable td:nth-child(13), /* P승률 컬럼 */
        #fullStandingsTable td:nth-child(16), /* 1점차승률 컬럼 */
        #fullStandingsTable td:nth-child(17), /* 홈승률 컬럼 */
        #fullStandingsTable td:nth-child(18), /* 원정승률 컬럼 */
        #pythagoreanTable td:nth-child(3),    /* 실제승률 컬럼 */
        #pythagoreanTable td:nth-child(4),    /* 기대승률 컬럼 */
        #clutchTable td:nth-child(4),         /* 1점차승률 컬럼 */
        #clutchTable td:nth-child(9) {        /* 클러치지수 컬럼 */
            font-family: var(--winrate-font-family) !important;
            font-weight: var(--winrate-font-weight) !important;
        }
        
        /* 모든 테이블의 td 요소에만 강제 폰트 적용 (th는 제외) */
        table td *, table strong, table b, table span {
            font-family: inherit !important;
            font-weight: inherit !important;
        }
        
        /* 테이블 헤더는 별도로 폰트 강제 적용 - 최우선순위 */
        table th,
        .full-standings-table th,
        .detail-table th,
        .matrix-table th,
        #monthlyTable th,
        .weekly-table th,
        .all-teams-table th,
        .detailed-game-table th,
        .series-stats-table th,
        #weekdayTable th,
        th[style*="font-size"] {
            font-family: var(--font-family-base) !important;
            font-size: var(--font-base) !important;
            font-weight: var(--font-weight-semibold) !important;
        }
        
        /* 모든 테이블 헤더에 대한 최우선 적용 */
        * th {
            font-family: var(--font-family-base) !important;
            font-size: var(--font-base) !important;
        }
        
        /* 승률 관련 헤더 특별 처리 - 절대 우선순위 */
        table th:nth-child(8),   /* 승률 헤더 */
        table th:nth-child(13),  /* P승률 헤더 */
        table th:nth-child(16),  /* 1점차승률 헤더 */
        table th:nth-child(17),  /* 홈승률 헤더 */
        table th:nth-child(18),  /* 원정승률 헤더 */
        #fullStandingsTable th:nth-child(8),
        #fullStandingsTable th:nth-child(13),
        #fullStandingsTable th:nth-child(16),
        #fullStandingsTable th:nth-child(17),
        #fullStandingsTable th:nth-child(18) {
            font-family: var(--font-family-base) !important;
            font-size: var(--font-base) !important;
            font-weight: var(--font-weight-semibold) !important;
        }
        
        /* 숫자가 포함된 모든 셀에 데이터 폰트 강제 적용 */
        table td:not(.team-name):not(.opponent-cell):not(.date-cell):not(.venue-cell):not(.result-cell) {
            font-family: var(--data-font-family) !important;
            font-weight: var(--data-font-weight) !important;
        }
        
        /* 팀명과 텍스트 셀 제외한 모든 strong 태그 */
        table td:not(.team-name):not(.opponent-cell):not(.date-cell):not(.venue-cell):not(.result-cell) strong,
        table td:not(.team-name):not(.opponent-cell):not(.date-cell):not(.venue-cell):not(.result-cell) b {
            font-family: var(--data-font-family) !important;
            font-weight: var(--font-weight-bold) !important;
        }


        .team-selector {
            text-align: center;
            margin: 15px 0;
        }

        /* 탑으로 가기 버튼 스타일 - magic-number 스타일 적용 */
        .scroll-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            background: #1a237e;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            z-index: 9999;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            transform: translateY(20px);
        }

        .scroll-to-top:hover {
            background: #3949ab;
            box-shadow: 0 6px 16px rgba(0,0,0,0.3);
        }

        .scroll-to-top.show:hover {
            transform: translateY(-2px);
        }

        .scroll-to-top.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* 모바일에서 버튼 크기 조정 */
        @media (max-width: 768px) {
            .scroll-to-top {
                bottom: 20px;
                right: 20px;
                width: 45px;
                height: 45px;
                font-size: 18px;
            }
        }

        .team-selector select {
            padding: 8px 16px;
            font-size: var(--font-base);
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            background: white;
        }

        .streak-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            background: #f8fafc;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .streak-item {
            text-align: center;
        }

        .streak-label {
            display: block;
            font-size: var(--font-sm);
            color: #718096;
            margin-bottom: 5px;
        }

        .streak-value {
            display: block;
            font-size: var(--font-xl);
            font-weight: var(--font-weight-semibold);
        }

        .win-streak {
            color: #38a169;
        }

        .lose-streak {
            color: #e53e3e;
        }


        .result-badge {
            padding: 4px 8px;
            border-radius: 8px;
            font-size: var(--font-xs);
            font-weight: var(--font-weight-semibold);
            color: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        .result-badge.w {
            background: #27ae60;
        }

        .result-badge.l {
            background: #e74c3c;
        }

        .result-badge.d {
            background: #f39c12;
        }

        /* 연승/연패 색상 스타일 - 폰트 색상 */
        .streak-hot {
            color: #e74c3c !important;
            font-weight: var(--font-weight-bold);
        }
        
        .streak-warm {
            color: #f39c12 !important;
            font-weight: var(--font-weight-semibold);
        }
        
        .streak-neutral {
            color: #7f8c8d !important;
        }
        
        .streak-cool {
            color: #e67e22 !important;
            font-weight: var(--font-weight-semibold);
        }
        
        .streak-cold {
            color: #3498db !important;
            font-weight: var(--font-weight-bold);
        }


        .all-teams-table {
            width: 100%;
            border-collapse: collapse;
            font-size: var(--font-md);
        }

        .all-teams-table th,
        .all-teams-table td {
            border: 1px solid #d1d5db;
            padding: 6px;
            text-align: center;
            min-width: 40px;
        }

        .all-teams-table th {
            background: #34495e;
            color: white;
            font-weight: var(--font-weight-semibold);
            font-size: var(--font-base);
            font-family: var(--font-family-base);
        }

        .team-header-column {
            background: #34495e !important;
            color: white !important;
            font-weight: 900;
            font-size: var(--font-md);
            text-shadow: 0 1px 2px rgba(0,0,0,0.4);
        }

        .game-number-cell {
            font-weight: var(--font-weight-bold);
            background: #fff3e0;
            font-size: var(--font-xs);
        }

        .game-result-cell {
            position: relative;
            padding: 4px;
            font-weight: var(--font-weight-semibold);
            font-size: var(--font-xs);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .game-result-cell:hover {
            transform: scale(1.1);
            z-index: 2;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .cell-win {
            background: var(--positive-bg-medium);
            color: var(--positive-color);
            font-weight: var(--font-weight-semibold);
            font-size: var(--font-sm);
        }

        .cell-loss {
            background: var(--negative-bg-medium);
            color: var(--negative-color);
            font-weight: var(--font-weight-semibold);
            font-size: var(--font-sm);
        }

        .cell-draw {
            background: var(--neutral-bg-medium);
            color: var(--neutral-color);
            font-weight: var(--font-weight-semibold);
            font-size: var(--font-sm);
        }

        .win-row {
            color: var(--positive-color);
            font-size: var(--font-sm);
        }

        .loss-row {
            color: var(--negative-color);
            font-size: var(--font-sm);
        }

        .draw-row {
            color: var(--neutral-color);
            font-size: var(--font-sm);
        }

        .cell-empty {
            background: #f8fafc;
            color: #9ca3af;
        }

        .result-display {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1px;
        }

        .streak-number {
            font-size: var(--font-base);
            font-weight: var(--font-weight-bold);
            line-height: 1;
        }

        .result-letter {
            font-size: var(--font-xs);
            font-weight: var(--font-weight-semibold);
            opacity: 0.9;
        }

        /* 무승부일 때 글자 크기를 연승/연패 숫자만큼 크게 */
        .result-letter.draw-result {
            font-size: var(--font-base);
            font-weight: 900;
            opacity: 1;
            line-height: 1;
        }

        .combined-result {
            font-size: var(--font-base);
            font-weight: var(--font-weight-bold);
            line-height: 1;
            display: inline-block;
        }

        .legend {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .legend-item {
            display: flex;
            align-items: center;
            font-size: var(--font-md);
            color: #4a5568;
        }

        /* 팀별 상세 기록 스타일 */
        .team-detailed-records {
            background: white;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #e2e8f0;
        }

        .team-stats-summary {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid #e2e8f0;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
        }

        .stat-card {
            background: #f8f9fa;
            border-radius: 6px;
            padding: 12px 8px;
            text-align: center;
            border: 1px solid #e9ecef;
        }

        .stat-card:hover {
            background: #e9ecef;
        }

        .stat-title {
            font-size: var(--font-xs);
            color: #718096;
            margin-bottom: 4px;
            font-weight: var(--font-weight-medium);
            line-height: 1.2;
        }

        .stat-number {
            font-size: var(--font-xl);
            font-weight: var(--font-weight-bold);
            color: #2d3748;
            margin-bottom: 2px;
            line-height: 1.2;
        }

        .stat-subtitle {
            font-size: var(--font-2xs);
            color: #a0aec0;
            font-weight: 400;
            line-height: 1.2;
        }

        .win-color {
            color: #38a169 !important;
        }

        .loss-color {
            color: #e53e3e !important;
        }

        .detailed-game-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            font-size: var(--font-base);
        }

        .detailed-game-table th,
        .detailed-game-table td {
            border: 1px solid #d1d5db;
            padding: 8px 6px;
            text-align: center;
            vertical-align: middle;
            white-space: nowrap;
            font-size: var(--font-base);
        }

        .detailed-game-table th {
            background: #34495e;
            color: white;
            font-weight: var(--font-weight-semibold);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .detailed-game-table th.sortable {
            cursor: pointer;
            user-select: none;
            transition: all 0.2s ease;
        }

        .detailed-game-table th.sortable:hover {
            background: #2c3e50;
            transform: translateY(-1px);
        }

        .detailed-game-table tbody tr:hover {
            background-color: #f8f9fa;
        }

        .detailed-game-table tbody tr:nth-child(even) {
            background-color: #fdfdfd;
        }

        .detailed-game-table tbody tr:nth-child(even):hover {
            background-color: #f8f9fa;
        }

        .game-num-cell {
            font-weight: var(--font-weight-bold);
            color: #d97706;
            width: 60px;
            max-width: 60px;
            text-align: center;
        }

        .date-cell {
            font-size: var(--font-sm);
            color: #2d3748;
            font-weight: var(--font-weight-medium);
            width: 180px;
            max-width: 180px;
            text-align: center;
            white-space: nowrap;
            overflow: visible;
            text-overflow: clip;
        }

        .weekday-date {
            color: #1f2937;
            font-weight: var(--font-weight-medium);
        }

        .weekend-date {
            color: #dc2626;
            font-weight: var(--font-weight-semibold);
        }

        .holiday-date {
            color: #dc2626;
            font-weight: var(--font-weight-semibold);
        }

        .opponent-cell {
            font-weight: var(--font-weight-semibold);
            color: #1a202c;
        }

        .venue-cell {
            font-size: var(--font-sm);
            color: #2d3748;
            font-weight: var(--font-weight-medium);
        }

        .home-venue {
            color: #2563eb;
            font-weight: var(--font-weight-semibold);
        }

        .away-venue {
            color: #dc2626;
            font-weight: var(--font-weight-semibold);
        }

        .score-cell {
            font-family: var(--data-font-family);
            font-weight: var(--data-font-weight);
            font-size: var(--data-font-size);
            text-align: center;
        }

        .runs-cell {
            font-family: var(--data-font-family);
            font-weight: var(--data-font-weight);
            font-size: var(--data-font-size);
            text-align: center;
        }

        .diff-cell {
            font-family: var(--data-font-family);
            font-weight: var(--font-weight-bold);
            font-size: var(--data-font-size);
            text-align: center;
        }

        .diff-cell.positive {
            color: #27ae60;
            font-weight: var(--font-weight-semibold);
        }

        .diff-cell.negative {
            color: #e74c3c;
            font-weight: var(--font-weight-semibold);
        }

        .diff-cell.neutral {
            color: #34495e;
        }


        /* 네비게이션 스타일 */
        .navigation {
            position: sticky;
            top: 0;
            z-index: 1000;
            margin-bottom: 20px;
            padding: 8px 0;
        }

        .navigation::before {
            content: "";
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: var(--card-width);
            max-width: var(--card-max-width);
            height: 100%;
            background: var(--card-background);
            backdrop-filter: var(--card-backdrop-filter);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: var(--card-border-radius);
            z-index: -1;
        }

        .nav-container {
            width: var(--card-width) !important;
            max-width: var(--card-max-width) !important;
            margin: 0 auto;
            padding: 0 10px;
            box-sizing: border-box;
        }

        .nav-menu {
            display: flex;
            justify-content: space-between;
            gap: 2px;
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
            flex-wrap: nowrap;
        }

        .nav-menu::-webkit-scrollbar {
            display: none;
        }

        .nav-item {
            white-space: nowrap;
            padding: 8px 14px;
            font-size: var(--font-md);
            font-weight: var(--font-weight-medium);
            color: #4a5568;
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.3s ease;
            border: 1px solid transparent;
            flex: 1;
            text-align: center;
            min-width: 80px;
        }

        .nav-item:hover {
            background: rgba(66, 153, 225, 0.15);
            color: #2563eb;
            border-color: rgba(66, 153, 225, 0.3);
            transform: translateY(-1px);
        }

        .nav-item.active {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            font-weight: var(--font-weight-semibold);
            border-color: #2563eb;
            box-shadow: 0 2px 4px rgba(59, 130, 246, 0.3);
        }

        .nav-item.active:hover {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            transform: translateY(-1px);
        }

        /* 매직넘버 카드 스타일 */
        .magic-number-card {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border: none;
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.2);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .magic-number-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 30px rgba(16, 185, 129, 0.3);
        }

        .magic-number-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0;
        }

        .magic-number-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .magic-number-icon {
            font-size: 3rem;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 80px;
            height: 80px;
        }

        .magic-number-text h3 {
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0 0 8px 0;
        }

        .magic-number-text p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1rem;
            margin: 0;
            line-height: 1.5;
        }

        .magic-number-button {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            text-decoration: none;
            padding: 12px 24px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            font-size: 1rem;
        }

        .magic-number-button:hover {
            background: rgba(255, 255, 255, 0.3);
            color: white;
            transform: translateX(4px);
        }

        .magic-number-button .arrow {
            transition: transform 0.3s ease;
        }

        .magic-number-button:hover .arrow {
            transform: translateX(4px);
        }

        @media (max-width: 768px) {
            .magic-number-content {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }

            .magic-number-left {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .magic-number-icon {
                width: 60px;
                height: 60px;
                font-size: 2rem;
            }

            .magic-number-text h3 {
                font-size: 1.3rem;
            }

            .magic-number-text p {
                font-size: 0.9rem;
            }

            .magic-number-button {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 1024px) {
            .nav-menu {
                justify-content: flex-start;
                gap: 1px;
            }
            .nav-item {
                font-size: var(--font-sm);
                padding: 6px 10px;
                min-width: 70px;
                flex: none;
            }
        }

        @media (max-width: 768px) {
            .nav-item {
                font-size: var(--font-sm);
                padding: 6px 8px;
                min-width: 60px;
            }
        }

        /* 시즌 진행률 카드 스타일 */

        .team-progress-item {
            padding: 12px;
            background: #ffffff;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            transition: all 0.3s ease;
        }

        .team-progress-item:hover {
            border-color: #3b82f6;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
            transform: translateY(-2px);
        }

        .team-progress-bar {
            height: 8px;
            background: #f3f4f6;
            border-radius: 4px;
            overflow: hidden;
            margin: 8px 0;
        }

        .team-progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 1.5s ease-out;
            position: relative;
        }

        .team-progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.15), transparent);
            /* 애니메이션 제거 - 정적인 글로우 효과만 */
        }

    </style>
</head>
<body>
    <!-- 헤더 -->
    <div class="header">
        <div class="header-content">
            <h1>🏆 KBO 2025 종합 분석 대시보드</h1>
            <p class="subtitle">실시간 순위 · 시즌 진행률 · 피타고리안 승률 · 클러치 지수 · 팀별 상대전적 등<br>
            KBO 리그의 모든 데이터를 한눈에 분석하는 종합 통계 플랫폼</p>
            <div class="update-info" id="updateInfo">
                📅 데이터 로딩 중...
            </div>
        </div>
    </div>

    <div class="container">

        <!-- 네비게이션 -->
        <nav class="navigation">
            <div class="nav-container">
                <div class="nav-menu">
                    <a href="#season-progress" class="nav-item">📈 진행률</a>
                    <a href="#standings" class="nav-item">🏆 종합순위</a>
                    <a href="#pythagorean" class="nav-item">📊 피타고리안</a>
                    <a href="#clutch" class="nav-item">⚾ 클러치</a>
                    <a href="#homeaway" class="nav-item">🏠 홈/원정</a>
                    <a href="#matrix" class="nav-item">📋 상대전적</a>
                    <a href="#remaining-games" class="nav-item">🔢 잔여경기</a>
                    <a href="#monthly" class="nav-item">📅 월별성적</a>
                    <a href="#weekday" class="nav-item">📆 요일별</a>
                    <a href="#weekly" class="nav-item">📈 주차별</a>
                    <a href="#gamerecords" class="nav-item">🎮 게임기록</a>
                    <a href="#teamdetail" class="nav-item">👥 팀상세</a>
                    <a href="#stadium" class="nav-item">🏟️ 경기장별</a>
                </div>
            </div>
        </nav>

        <!-- 매직넘버 계산기 링크 카드 -->
        <div class="card magic-number-card" style="margin-bottom: 30px;">
            <div class="magic-number-content">
                <div class="magic-number-left">
                    <div class="magic-number-icon">📊</div>
                    <div class="magic-number-text">
                        <h3>2025 KBO 매직넘버 계산기</h3>
                        <p>플레이오프 진출 조건과 우승 가능성을 상세히 분석해보세요</p>
                    </div>
                </div>
                <div class="magic-number-right">
                    <a href="magic-number/index.html" class="magic-number-button">
                        <span>자세히 보기</span>
                        <span class="arrow">→</span>
                    </a>
                </div>
            </div>
        </div>

        <!-- 시즌 진행률 카드 -->
        <div class="card" id="season-progress">
            <div class="card-header">
                <span class="card-icon">📈</span>
                <h2 class="card-title">2025 KBO 시즌 진행률</h2>
            </div>
            <div style="padding: 20px;">
                <!-- 전체 시즌 진행률 -->
                <div style="margin-bottom: 25px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <span style="font-weight: 600; font-size: 1.1rem; color: #374151;">전체 시즌 진행률</span>
                        <span id="overall-progress-text" style="font-weight: 700; font-size: 1.2rem; color: #059669;">0%</span>
                    </div>
                    <div style="background: #e5e7eb; border-radius: 10px; height: 20px; overflow: hidden; box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);">
                        <div id="overall-progress-bar" style="height: 100%; background: linear-gradient(90deg, #10b981 0%, #059669 100%); width: 0%; transition: width 1s ease-out; border-radius: 10px; position: relative;">
                            <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);"></div>
                        </div>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 8px; font-size: 0.9rem; color: #6b7280;">
                        <span>시즌 시작</span>
                        <span id="games-info">0/720 경기 완료</span>
                        <span>정규시즌 종료</span>
                    </div>
                </div>

                <!-- 팀별 경기 소화율 -->
                <div>
                    <h3 style="font-weight: 600; font-size: 1.1rem; color: #374151; margin-bottom: 15px; border-bottom: 2px solid #e5e7eb; padding-bottom: 8px;">팀별 경기 소화율</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px;" id="team-progress-container">
                        <!-- 팀별 진행률이 여기에 동적으로 생성됩니다 -->
                    </div>
                </div>

                <!-- 시즌 주요 일정 -->
                <div style="margin-top: 30px; padding: 15px; background: #f8fafc; border-radius: 8px; border-left: 4px solid #3b82f6;">
                    <h4 style="font-weight: 600; color: #1f2937; margin-bottom: 10px;">🗓️ 시즌 주요 일정</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; font-size: 0.9rem; color: #4b5563;">
                        <div><strong>정규시즌:</strong> 3월 ~ 9월</div>
                        <div><strong>총 경기:</strong> 720경기 (팀당 144경기)</div>
                        <div><strong>올스타전:</strong> 7월 11~12일 (대전)</div>
                        <div><strong>와일드카드:</strong> 10월 초</div>
                        <div><strong>플레이오프:</strong> 10월 중순</div>
                        <div><strong>한국시리즈:</strong> 10월 말</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 광고: 시즌 진행률과 종합 순위 사이 -->
        <div style="text-align: center; margin: 30px 0;">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-5508768187151867"
                 data-ad-slot="7298546648"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>

        <!-- 1. 종합 순위표 (전체 지표) -->
        <div class="card" id="standings">
            <div class="card-header">
                <span class="card-icon">🏆</span>
                <h2 class="card-title">종합 순위 - 전체 지표</h2>
            </div>
            <div class="table-container">
                <table class="full-standings-table" id="fullStandingsTable">
                    <thead>
                        <tr>
                            <th>순위</th>
                            <th>팀</th>
                            <th>경기</th>
                            <th>잔여경기</th>
                            <th>승</th>
                            <th>무</th>
                            <th>패</th>
                            <th>승률</th>
                            <th>게임차</th>
                            <th>득점</th>
                            <th>실점</th>
                            <th>득실차</th>
                            <th>P승률</th>
                            <th>운지수</th>
                            <th>1점차승률</th>
                            <th>홈승률</th>
                            <th>원정승률</th>
                            <th>홈우위</th>
                            <th onclick="event.stopPropagation(); sortByStreakNew();" class="no-sort" style="cursor: pointer;">연승패</th>
                            <th>최대연승</th>
                            <th>최대연패</th>
                        </tr>
                    </thead>
                    <tbody id="fullStandingsBody">
                        <!-- 동적으로 생성 -->
                    </tbody>
                </table>
            </div>
            
            <!-- 주요 지표 설명 -->
            <div style="margin-top: 15px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">
                <div style="font-size: var(--font-base); font-weight: var(--font-weight-medium); margin-bottom: 8px; color: #495057;">📈 주요 지표 간단 설명</div>
                <div style="font-size: var(--font-sm); color: #6c757d; line-height: 1.5; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 8px;">
                    <div><strong>득실차:</strong> 득점-실점 (높을수록 좋음)</div>
                    <div><strong>P승률:</strong> 피타고리안 기대승률 (득실차 기반)</div>
                    <div><strong>운지수:</strong> 실제승률-기대승률</div>
                    <div><strong>1점차승률:</strong> 1점 차이 경기에서의 승률</div>
                    <div><strong>홈우위:</strong> 홈승률-원정승률</div>
                    <div><strong>잔여경기:</strong> 정규시즌 총 144경기 중 남은 경기수</div>
                    <div><strong>연승패:</strong> 현재 연속 승/패 상태</div>
                </div>
            </div>
        </div>

        <!-- 광고 1: 종합순위표 후 -->
        <div style="text-align: center; margin: 30px 0;">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-5508768187151867"
                 data-ad-slot="7298546648"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>


        <!-- 2. 피타고리안 & 운 분석 -->
        <div class="card" id="pythagorean">
            <div class="card-header">
                <span class="card-icon">⚡</span>
                <h2 class="card-title">피타고리안 기대승률 & 운 지수 분석</h2>
            </div>
            
            <div class="table-container">
                <table class="detail-table" id="pythagoreanTable">
                    <thead>
                        <tr>
                            <th>순위</th>
                            <th>팀</th>
                            <th>실제승률</th>
                            <th>피타고리안 기대승률</th>
                            <th>운 지수</th>
                            <th>운 상태</th>
                            <th>득점</th>
                            <th>실점</th>
                            <th>경기당 득점</th>
                            <th>경기당 실점</th>
                        </tr>
                    </thead>
                    <tbody id="pythagoreanBody">
                        <!-- 동적으로 생성 -->
                    </tbody>
                </table>
            </div>
            
            <!-- 설명 섹션 -->
            <div style="margin-top: 15px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">
                <div style="font-size: var(--font-base); font-weight: var(--font-weight-medium); margin-bottom: 8px; color: #495057;">📊 지표 설명</div>
                <div style="font-size: var(--font-sm); color: #6c757d; line-height: 1.5;">
                    <div style="margin-bottom: 6px;"><strong>피타고리안 기대승률:</strong> 득점과 실점으로 계산한 '이론적' 승률 (득점²÷(득점²+실점²))</div>
                    <div style="margin-bottom: 6px;"><strong>운 지수:</strong> 실제승률 - 기대승률 (양수: 운이 좋음, 음수: 운이 나쁨)</div>
                    <div><strong>운 상태:</strong> +0.05 이상(매우 좋음), +0.02~0.05(좋음), -0.02~+0.02(평균적), -0.05 이하(나쁨)</div>
                </div>
            </div>
        </div>

        <!-- 광고 8: 피타고리안 분석 후 -->
        <div style="text-align: center; margin: 30px 0;">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-5508768187151867"
                 data-ad-slot="7298546648"
                 data-ad-format="auto"
                 data-full-width-responsive="true">
            </ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>

        <!-- 3. 클러치 상황 분석 -->
        <div class="card" id="clutch">
            <div class="card-header">
                <span class="card-icon">🎯</span>
                <h2 class="card-title">클러치 상황 분석</h2>
            </div>
            
            <div class="table-container">
                <table class="detail-table" id="clutchTable">
                    <thead>
                        <tr>
                            <th>순위</th>
                            <th>팀</th>
                            <th>1점차승</th>
                            <th>1점차패</th>
                            <th>1점차승률</th>
                            <th>대량득점</th>
                            <th>대량실점</th>
                            <th>완봉승</th>
                            <th>완봉패</th>
                            <th>클러치지수</th>
                        </tr>
                    </thead>
                    <tbody id="clutchBody">
                        <!-- 동적으로 생성 -->
                    </tbody>
                </table>
            </div>
            
            <!-- 설명 섹션 -->
            <div style="margin-top: 15px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">
                <div style="font-size: var(--font-base); font-weight: var(--font-weight-medium); margin-bottom: 8px; color: #495057;">🎯 클러치 지표 설명</div>
                <div style="font-size: var(--font-sm); color: #6c757d; line-height: 1.5;">
                    <div style="margin-bottom: 6px;"><strong>클러치:</strong> 중요한 순간, 특히 승부가 갈리는 상황에서의 경기력</div>
                    <div style="margin-bottom: 6px;"><strong>1점차 경기:</strong> 1점 차이로 승부가 난 경기 (가장 치열한 접전)</div>
                    <div style="margin-bottom: 6px;"><strong>클러치 지수:</strong> 1.00 기준, 높을수록 중요한 순간에 강함</div>
                    <div><strong>대량득점/실점:</strong> 5점 이상 득점하거나 5점 이상 내준 경기 수</div>
                </div>
            </div>
        </div>

        <!-- 광고 2: 클러치 분석 후 -->
        <div style="text-align: center; margin: 30px 0;">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-5508768187151867"
                 data-ad-slot="7298546648"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>

        <!-- 4. 홈/원정 상세 분석 -->
        <div class="card" id="homeaway">
            <div class="card-header">
                <span class="card-icon">🏟️</span>
                <h2 class="card-title">홈/원정 상세 분석</h2>
            </div>
            
            <div class="table-container">
                <table class="detail-table" id="homeAwayTable">
                    <thead>
                        <tr>
                            <th>순위</th>
                            <th style="min-width: 80px;">팀</th>
                            <th>홈 경기</th>
                            <th>홈 승</th>
                            <th>홈 패</th>
                            <th>홈 승률</th>
                            <th>원정 경기</th>
                            <th>원정 승</th>
                            <th>원정 패</th>
                            <th>원정 승률</th>
                            <th>홈 어드밴티지</th>
                            <th>홈구장</th>
                        </tr>
                    </thead>
                    <tbody id="homeAwayBody">
                        <!-- 동적으로 생성 -->
                    </tbody>
                </table>
            </div>
            
            <!-- 설명 섹션 -->
            <div style="margin-top: 15px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">
                <div style="font-size: var(--font-base); font-weight: var(--font-weight-medium); margin-bottom: 8px; color: #495057;">🏟️ 홈/원정 지표 설명</div>
                <div style="font-size: var(--font-sm); color: #6c757d; line-height: 1.5;">
                    <div style="margin-bottom: 6px;"><strong>홈 경기:</strong> 자기 팀 구장에서 치르는 경기 (관중 응원, 환경 익숙함 등 유리)</div>
                    <div style="margin-bottom: 6px;"><strong>원정 경기:</strong> 상대 팀 구장에서 치르는 경기 (불리한 환경)</div>
                    <div><strong>홈 어드밴티지:</strong> 홈승률 - 원정승률 (양수일수록 홈에서 강함, 보통 0.05~0.15)</div>
                </div>
            </div>
        </div>

        <!-- 쿠팡 광고 1: 홈/원정 분석 후 -->
        <div class="ad-card">
            <div style="font-size: 0.8rem; color: #666; margin-bottom: 10px;">광고</div>
            <script src="https://ads-partners.coupang.com/g.js"></script>
            <script>
                new PartnersCoupang.G({"id":867629,"trackingCode":"AF6959276","subId":null,"template":"carousel","width":"100%","height":"180"});
            </script>
        </div>


        <!-- 5. 상대전적 매트릭스 -->
        <div class="card" id="matrix">
            <div class="card-header">
                <span class="card-icon">⚔️</span>
                <h2 class="card-title">팀간 상대전적 매트릭스</h2>
            </div>
            <div class="table-container">
                <div id="matrixContent">
                    <!-- 동적으로 생성 -->
                </div>
            </div>
        </div>

        <!-- 광고 5: 상대전적 매트릭스 후 -->
        <div style="text-align: center; margin: 30px 0;">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-5508768187151867"
                 data-ad-slot="7298546648"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>

        <!-- 5-2. 팀간 잔여경기수 -->
        <div class="card" id="remaining-games">
            <div class="card-header">
                <span class="card-icon">📅</span>
                <h2 class="card-title">팀간 잔여경기수</h2>
            </div>
            <div class="table-container">
                <div id="remainingGamesContent">
                    <!-- 동적으로 생성 -->
                </div>
            </div>
        </div>

        <!-- 광고 11: 팀간 잔여경기수 후 -->
        <div style="text-align: center; margin: 30px 0;">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-5508768187151867"
                 data-ad-slot="7298546648"
                 data-ad-format="auto"
                 data-full-width-responsive="true">
            </ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>

        <!-- 6. 월별 성적 완전 분석 -->
        <div class="card" id="monthly">
            <div class="card-header">
                <span class="card-icon">📊</span>
                <h2 class="card-title">월별 성적 분석</h2>
            </div>
            <div class="table-container">
                <table class="detail-table" id="monthlyTable">
                    <thead id="monthlyTableHead">
                        <!-- 동적으로 생성 -->
                    </thead>
                    <tbody id="monthlyBody">
                        <!-- 동적으로 생성 -->
                    </tbody>
                </table>
            </div>
            
            <!-- 월별 성적 분석 설명 -->
            <div style="margin-top: 15px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">
                <div style="font-size: var(--font-base); font-weight: var(--font-weight-medium); margin-bottom: 8px; color: #495057;">📊 월별 성적 설명</div>
                <div style="font-size: var(--font-sm); color: #6c757d; line-height: 1.5;">
                    <div style="margin-bottom: 6px;"><strong>월별 성적:</strong> 3월부터 8월까지 각 월별 승패 기록과 승률 분석</div>
                    <div style="margin-bottom: 6px;"><strong>최고월/최저월:</strong> 각 팀의 가장 좋았던 월과 나빴던 월을 배경색으로 강조</div>
                    <div style="margin-bottom: 10px;"><strong>색상 구분:</strong> <span style="background: var(--positive-bg-medium); padding: 2px 6px; border-radius: 3px;">0.500 초과 (좋음)</span> <span style="background: var(--neutral-bg-light); padding: 2px 6px; border-radius: 3px;">0.500 (보통)</span> <span style="background: var(--negative-bg-medium); padding: 2px 6px; border-radius: 3px;">0.500 미만 (나쁨)</span></div>
                </div>
                <div style="font-size: var(--font-xs); color: #8e9194; border-top: 1px solid #e9ecef; padding-top: 8px;">
                    <div style="display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 6px;">
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <div style="width: 16px; height: 12px; background: var(--positive-bg-strong); border-radius: 2px;"></div>
                            <span>최고월 강조</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <div style="width: 16px; height: 12px; background: var(--negative-bg-strong); border-radius: 2px;"></div>
                            <span>최저월 강조</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 광고 3: 월별 성적 분석 후 -->
        <div style="text-align: center; margin: 30px 0;">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-5508768187151867"
                 data-ad-slot="7298546648"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>

        <!-- 7. 요일별 성적 완전 분석 -->
        <div class="card" id="weekday">
            <div class="card-header">
                <span class="card-icon">📅</span>
                <h2 class="card-title">요일별 성적 분석</h2>
            </div>
            <div class="table-container">
                <table class="detail-table" id="weekdayTable">
                    <thead>
                        <tr>
                            <th>순위</th>
                            <th>팀</th>
                            <th>월요일</th>
                            <th>화요일</th>
                            <th>수요일</th>
                            <th>목요일</th>
                            <th>금요일</th>
                            <th>토요일</th>
                            <th>일요일</th>
                            <th>주말승률</th>
                            <th>평일승률</th>
                        </tr>
                    </thead>
                    <tbody id="weekdayBody">
                        <!-- 동적으로 생성 -->
                    </tbody>
                </table>
            </div>
            
            <!-- 요일별 성적 분석 설명 -->
            <div style="margin-top: 15px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">
                <div style="font-size: var(--font-base); font-weight: var(--font-weight-medium); margin-bottom: 8px; color: #495057;">📅 요일별 성적 설명</div>
                <div style="font-size: var(--font-sm); color: #6c757d; line-height: 1.5;">
                    <div style="margin-bottom: 6px;"><strong>요일별 승률:</strong> 월요일부터 일요일까지 각 요일별 성적 분석</div>
                    <div style="margin-bottom: 6px;"><strong>주말 승률:</strong> 토요일, 일요일 경기 합산 승률</div>
                    <div style="margin-bottom: 6px;"><strong>평일 승률:</strong> 월요일~금요일 경기 합산 승률</div>
                    <div><strong>색상 구분:</strong> <span style="background: var(--positive-bg-medium); padding: 2px 6px; border-radius: 3px;">0.500 초과 (좋음)</span> <span style="background: var(--neutral-bg-light); padding: 2px 6px; border-radius: 3px;">0.500 (보통)</span> <span style="background: var(--negative-bg-medium); padding: 2px 6px; border-radius: 3px;">0.500 미만 (나쁨)</span></div>
                </div>
            </div>
        </div>

        <!-- 광고 6: 요일별 성적 분석 후 -->
        <div style="text-align: center; margin: 30px 0;">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-5508768187151867"
                 data-ad-slot="7298546648"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>

        <!-- 8. 주차별 성적 분석 -->
        <div class="card" id="weekly">
            <div class="card-header">
                <span class="card-icon">📅</span>
                <h2 class="card-title">주차별 성적 분석</h2>
            </div>
            <div id="weeklyStatsContent">
                <div style="text-align: center; padding: 40px; color: #666;">
                    데이터를 로드하고 있습니다...
                </div>
            </div>
        </div>

        <!-- 쿠팡 광고 2: 주차별 성적 분석 후 -->
        <div class="ad-card">
            <div style="font-size: 0.8rem; color: #666; margin-bottom: 10px;">광고</div>
            <script src="https://ads-partners.coupang.com/g.js"></script>
            <script>
                new PartnersCoupang.G({"id":867629,"trackingCode":"AF6959276","subId":null,"template":"carousel","width":"100%","height":"180"});
            </script>
        </div>

        <!-- 9. 게임별 기록 분석 -->
        <div class="card" id="gamerecords">
            <div class="card-header">
                <span class="card-icon">🏆</span>
                <h2 class="card-title">게임별 기록 & 연승/연패 분석</h2>
            </div>
            <div id="gameRecordsContent">
                <div style="text-align: center; padding: 40px; color: #666;">
                    데이터를 로드하고 있습니다...
                </div>
            </div>
        </div>

        <!-- 광고 9: 게임별 기록 분석 후 -->
        <div style="text-align: center; margin: 30px 0;">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-5508768187151867"
                 data-ad-slot="7298546648"
                 data-ad-format="auto"
                 data-full-width-responsive="true">
            </ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>

        <!-- 10. 팀별 상세 게임 기록 -->
        <div class="card" id="teamdetail">
            <div class="card-header">
                <span class="card-icon">📋</span>
                <h2 class="card-title">팀별 상세 게임 기록</h2>
            </div>
            <div id="teamDetailedRecordsContent">
                <div style="text-align: center; padding: 40px; color: #666;">
                    데이터를 로드하고 있습니다...
                </div>
            </div>
        </div>

        <!-- 광고 4: 팀별 상세 게임 기록 후 -->
        <div style="text-align: center; margin: 30px 0;">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-5508768187151867"
                 data-ad-slot="7298546648"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>

        <!-- 11. 위닝/루징 시리즈 및 스윕 -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">⚔️</span>
                <h2 class="card-title">위닝/루징 시리즈 분석</h2>
            </div>
            <div id="seriesAnalysisContent">
                <div style="text-align: center; padding: 40px; color: #666;">
                    데이터를 로드하고 있습니다...
                </div>
            </div>
        </div>

        <!-- 광고 7: 위닝/루징 시리즈 분석 후 -->
        <div style="text-align: center; margin: 30px 0;">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-5508768187151867"
                 data-ad-slot="7298546648"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>

        <!-- 12. 경기장별 성적 완전 분석 -->
        <div class="card" id="stadium">
            <div class="card-header">
                <span class="card-icon">🏟️</span>
                <h2 class="card-title">경기장별 성적 분석</h2>
            </div>
            <div class="table-container">
                <table class="detail-table" id="stadiumTable">
                    <thead id="stadiumTableHead">
                        <!-- 동적으로 생성 -->
                    </thead>
                    <tbody id="stadiumTableBody">
                        <!-- 동적으로 생성 -->
                    </tbody>
                </table>
            </div>
            
            <!-- 설명 섹션 -->
            <div style="margin-top: 15px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">
                <div style="font-size: var(--font-base); font-weight: var(--font-weight-medium); margin-bottom: 8px; color: #495057;">🏟️ 경기장별 성적 설명</div>
                <div style="font-size: var(--font-sm); color: #6c757d; line-height: 1.5;">
                    <div style="margin-bottom: 6px;"><strong>파란색 배경:</strong> 해당 팀의 홈구장 (🏠 표시) - 홈팀이 유리한 환경</div>
                    <div><strong>경기수:</strong> 해당 경기장에서 치른 총 경기 수</div>
                </div>
            </div>
        </div>

        <!-- 광고 10: 경기장별 성적 분석 후 -->
        <div style="text-align: center; margin: 30px 0;">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-5508768187151867"
                 data-ad-slot="7298546648"
                 data-ad-format="auto"
                 data-full-width-responsive="true">
            </ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>

        <!-- 푸터 제거됨 -->

    <script>
        let dashboardData = null;
        let weeklyAnalysisData = null;
        let gameRecordsData = null;
        let currentSelectedTeam = 'LG';
        
        // 승률에 따른 5단계 클래스 반환 함수
        function getWinRateClass(winRate) {
            if (typeof winRate === 'string') {
                winRate = parseFloat(winRate);
            }
            
            // 승률에 따른 5단계 분류
            if (winRate >= 0.650) {
                return 'positive-very-strong';  // 매우 좋음 (0.650 이상)
            } else if (winRate >= 0.550) {
                return 'positive-strong';        // 좋음 (0.550 ~ 0.649)
            } else if (winRate >= 0.520) {
                return 'positive-medium';        // 약간 좋음 (0.520 ~ 0.549)
            } else if (winRate >= 0.500) {
                return 'neutral-medium';         // 보통 (0.500 ~ 0.519)
            } else if (winRate >= 0.480) {
                return 'neutral-light';          // 약간 나쁨 (0.480 ~ 0.499)
            } else if (winRate >= 0.450) {
                return 'negative-medium';        // 나쁨 (0.450 ~ 0.479)
            } else if (winRate >= 0.350) {
                return 'negative-strong';        // 매우 나쁨 (0.350 ~ 0.449)
            } else {
                return 'negative-very-strong';   // 최악 (0.350 미만)
            }
        }

        // 득실차에 따른 5단계 클래스 반환 함수
        function getRunDiffClass(runDiff) {
            if (typeof runDiff === 'string') {
                runDiff = parseInt(runDiff);
            }
            
            if (runDiff >= 100) {
                return 'positive-very-strong';  // 매우 좋음 (+100 이상)
            } else if (runDiff >= 50) {
                return 'positive-strong';        // 좋음 (+50 ~ +99)
            } else if (runDiff >= 20) {
                return 'positive-medium';        // 약간 좋음 (+20 ~ +49)
            } else if (runDiff > 0) {
                return 'positive-light';         // 미세하게 좋음 (+1 ~ +19)
            } else if (runDiff === 0) {
                return 'neutral-medium';         // 균형 (0)
            } else if (runDiff >= -19) {
                return 'negative-light';         // 미세하게 나쁨 (-19 ~ -1)
            } else if (runDiff >= -49) {
                return 'negative-medium';        // 약간 나쁨 (-49 ~ -20)
            } else if (runDiff >= -99) {
                return 'negative-strong';        // 나쁨 (-99 ~ -50)
            } else {
                return 'negative-very-strong';   // 매우 나쁨 (-100 이하)
            }
        }
        
        // CSS 변수를 JavaScript에서 직접 정의 (인라인 스타일 호환성을 위해)
        const colorScheme = {
            positive: {
                bgLight: 'rgba(34, 197, 94, 0.05)',
                bgMedium: 'rgba(34, 197, 94, 0.1)',
                bgStrong: 'rgba(34, 197, 94, 0.15)',
                color: '#059669'
            },
            negative: {
                bgLight: 'rgba(239, 68, 68, 0.05)',
                bgMedium: 'rgba(239, 68, 68, 0.1)',
                bgStrong: 'rgba(239, 68, 68, 0.15)',
                color: '#dc2626'
            },
            neutral: {
                bgLight: 'rgba(255, 193, 7, 0.1)',
                bgMedium: 'rgba(255, 193, 7, 0.2)',
                bgStrong: 'rgba(255, 193, 7, 0.3)',
                color: '#f59e0b'
            },
            default: {
                bg: '#f8f9fa',
                color: '#666'
            }
        };

        // 팀 로고 매핑 (통합)
        const teamLogos = {
            'LG': 'magic-number/images/lg.png',
            'KIA': 'magic-number/images/kia.png',
            'SSG': 'magic-number/images/ssg.png',
            '두산': 'magic-number/images/doosan.png',
            '삼성': 'magic-number/images/samsung.png',
            'KT': 'magic-number/images/kt.png',
            'NC': 'magic-number/images/nc.png',
            '롯데': 'magic-number/images/lotte.png',
            '키움': 'magic-number/images/kiwoom.png',
            '한화': 'magic-number/images/hanwha.png'
        };

        // 팀명과 로고를 함께 표시하는 함수 (통합)
        function getTeamWithLogo(teamName, className = 'team-logo-small') {
            const logoPath = teamLogos[teamName];
            if (logoPath) {
                return `<span class="team-name-with-logo">
                    <img src="${logoPath}" 
                         alt="${teamName}" 
                         class="${className}" 
                         style="width: 20px; height: 20px; margin-right: 5px; vertical-align: middle;"
                         onerror="this.style.display='none'; console.warn('로고 로드 실패:', '${teamName}', '${logoPath}');">
                    ${teamName}
                </span>`;
            }
            console.warn('팀 로고 매핑 없음:', teamName);
            return `<span>${teamName}</span>`;
        }

        // 데이터 정보 업데이트 함수 (header + footer)
        function updateDataInfo(data) {
            try {
                // enhanced-dashboard.json에서는 updateTime 필드 사용
                const updateTimeField = data?.lastUpdated || data?.updateTime;
                if (updateTimeField) {
                    const lastUpdated = new Date(updateTimeField);
                    const updateTimeText = lastUpdated.toLocaleString('ko-KR', { 
                        year: 'numeric',
                        month: 'numeric', 
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    }).replace(/\. /g, '. ').replace(/\.$/, '');
                    
                    // 헤더 업데이트
                    const updateInfoElement = document.getElementById('updateInfo');
                    if (updateInfoElement) {
                        updateInfoElement.textContent = `📅 ${updateTimeText} 데이터 사용중`;
                        console.log('📊 헤더 데이터 정보 업데이트:', updateTimeText);
                    }
                    
                    // Footer 업데이트
                    const dataInfoElement = document.querySelector('.data-info');
                    if (dataInfoElement) {
                        dataInfoElement.textContent = `${updateTimeText} 데이터 사용중`;
                        console.log('📊 Footer 데이터 정보 업데이트:', updateTimeText);
                    }
                } else {
                    console.warn('⚠️ 데이터 정보 업데이트 실패: updateTime/lastUpdated 데이터 없음', data);
                }
            } catch (error) {
                console.error('❌ 데이터 정보 업데이트 실패:', error);
            }
        }
        
        // 데이터 로드
        async function loadDashboardData() {
            try {
                console.log('🔄 데이터 로드 시작...');
                const response = await fetch('magic-number/data/enhanced-dashboard.json');
                console.log('📡 Fetch 응답:', response.status, response.ok);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                dashboardData = await response.json();
                console.log('📊 대시보드 데이터 로드 완료:', {
                    standings: dashboardData.standings?.length || 0,
                    weekdayPerformance: Object.keys(dashboardData.weekdayPerformance || {}).length,
                    stadiumRecords: Object.keys(dashboardData.stadiumRecords || {}).length
                });
                
                console.log('🎯 renderDashboard 호출 시작');
                await renderDashboard();
                
                // 데이터 정보 업데이트 (renderDashboard 호출 후)
                updateDataInfo(dashboardData);
                console.log('✅ 모든 데이터 로드 및 렌더링 완료');
                return Promise.resolve();
            } catch (error) {
                console.error('❌ 데이터 로드 실패:', error);
                const updateInfoElement = document.getElementById('updateInfo');
                if (updateInfoElement) {
                    updateInfoElement.textContent = '❌ 데이터 로드 실패';
                }
                return Promise.reject(error);
            }
        }

        // 주차별 분석 데이터 로드
        async function loadWeeklyAnalysisData() {
            try {
                console.log('🔄 주차별/게임별/팀별 데이터 로드 시작...');
                
                const [weeklyResponse, recordsResponse] = await Promise.all([
                    fetch('magic-number/data/weekly-analysis.json'),
                    fetch('magic-number/data/game-by-game-records.json')
                ]);
                
                console.log('📡 주차별 데이터 응답:', weeklyResponse.status, weeklyResponse.ok);
                console.log('📡 게임별 데이터 응답:', recordsResponse.status, recordsResponse.ok);
                
                if (!weeklyResponse.ok) {
                    throw new Error(`주차별 데이터 HTTP ${weeklyResponse.status}: ${weeklyResponse.statusText}`);
                }
                if (!recordsResponse.ok) {
                    throw new Error(`게임별 데이터 HTTP ${recordsResponse.status}: ${recordsResponse.statusText}`);
                }
                
                weeklyAnalysisData = await weeklyResponse.json();
                gameRecordsData = await recordsResponse.json();
                
                console.log('📊 주차별 데이터 키:', Object.keys(weeklyAnalysisData));
                console.log('📊 게임별 데이터 키:', Object.keys(gameRecordsData));
                
                // 각각 개별 렌더링
                console.log('🎯 renderWeeklyTable 호출');
                renderWeeklyTable();
                
                console.log('🎯 renderGameByGameTable 호출');
                renderGameByGameTable();
                
                console.log('🎯 renderTeamDetailedRecords 호출');
                renderTeamDetailedRecords();
                
                console.log('✅ 모든 주차별/게임별/팀별 데이터 렌더링 완료');
                
            } catch (error) {
                console.error('❌ 주차별 분석 데이터 로드 실패:', error);
                document.getElementById('weeklyStatsContent').innerHTML = 
                    `<div style="text-align: center; padding: 40px; color: #e53e3e;">❌ 주차별 데이터 로드 실패: ${error.message}</div>`;
                document.getElementById('gameRecordsContent').innerHTML = 
                    `<div style="text-align: center; padding: 40px; color: #e53e3e;">❌ 게임별 데이터 로드 실패: ${error.message}</div>`;
                document.getElementById('teamDetailedRecordsContent').innerHTML = 
                    `<div style="text-align: center; padding: 40px; color: #e53e3e;">❌ 팀별 상세 데이터 로드 실패: ${error.message}</div>`;
            }
        }

        // 대시보드 렌더링
        async function renderDashboard() {
            if (!dashboardData) {
                console.error('❌ dashboardData가 없습니다');
                return;
            }

            console.log('📊 대시보드 렌더링 시작');
            
            // 업데이트 정보는 updateDataInfo 함수에서 처리됨

            console.log('1️⃣ renderFullStandings 호출');
            try { renderFullStandings(); } catch(e) { console.error('renderFullStandings 오류:', e); }
            
            console.log('2️⃣ renderPythagoreanFullAnalysis 호출');
            try { renderPythagoreanFullAnalysis(); } catch(e) { console.error('renderPythagoreanFullAnalysis 오류:', e); }
            
            console.log('3️⃣ renderClutchFullAnalysis 호출');
            try { await renderClutchFullAnalysis(); } catch(e) { console.error('renderClutchFullAnalysis 오류:', e); }
            
            console.log('4️⃣ renderHomeAwayFullAnalysis 호출');
            try { await renderHomeAwayFullAnalysis(); } catch(e) { console.error('renderHomeAwayFullAnalysis 오류:', e); }
            
            console.log('5️⃣ renderHeadToHeadMatrix 호출');
            try { 
                if (typeof renderHeadToHeadMatrix === 'function') {
                    renderHeadToHeadMatrix(); 
                }
            } catch(e) { 
                console.error('renderHeadToHeadMatrix 오류:', e); 
                // 에러가 발생해도 계속 진행
            }

            console.log('5-2️⃣ renderRemainingGamesMatrix 호출');
            try { 
                if (typeof renderRemainingGamesMatrix === 'function') {
                    renderRemainingGamesMatrix(); 
                }
            } catch(e) { 
                console.error('renderRemainingGamesMatrix 오류:', e); 
                // 에러가 발생해도 계속 진행
            }
            
            console.log('6️⃣ renderMonthlyFullAnalysis 호출');
            try { renderMonthlyFullAnalysis(); } catch(e) { console.error('renderMonthlyFullAnalysis 오류:', e); }
            
            console.log('7️⃣ renderWeekdayFullAnalysis 호출');
            try { renderWeekdayFullAnalysis(); } catch(e) { console.error('renderWeekdayFullAnalysis 오류:', e); }
            
            console.log('8️⃣ renderStadiumFullAnalysis 호출');
            try { renderStadiumFullAnalysis(); } catch(e) { console.error('renderStadiumFullAnalysis 오류:', e); }
            
            console.log('✅ 대시보드 렌더링 완료');
        }

        // 팀 변경
        function changeSelectedTeam(team) {
            currentSelectedTeam = team;
            renderTeamDetailedRecords();
        }

        // 주차별 성적 테이블 렌더링
        function renderWeeklyTable() {
            if (!weeklyAnalysisData || !weeklyAnalysisData.weeklyAnalysis) {
                console.error('주차별 데이터가 올바르지 않습니다');
                return;
            }

            const teams = ['LG', '한화', 'KIA', '삼성', 'KT', 'SSG', '롯데', '두산', 'NC', '키움'];
            const maxWeeks = weeklyAnalysisData.currentWeek || 21;

            let html = `
            <div class="table-scroll-wrapper">
                <table class="weekly-table">
                    <thead>
                        <tr>
                            <th rowspan="2" style="min-width: 60px;">주차</th>
                            <th rowspan="2" style="min-width: 120px;">기간</th>
                            <th colspan="${teams.length}">팀별 성적 (승-패-무 / 승률)</th>
                        </tr>
                        <tr>
                            ${teams.map(team => `<th class="team-header">${getTeamWithLogo(team, 'team-logo-small')}</th>`).join('')}
                        </tr>
                    </thead>
                    <tbody>`;

            for (let week = 1; week <= maxWeeks; week++) {
                let weekStart, weekEnd, startStr, endStr;
                
                if (week === 1) {
                    // 1주차는 특별히 3월 22일, 23일 (토일)
                    weekStart = new Date('2025-03-22');
                    weekEnd = new Date('2025-03-23');
                } else {
                    // 2주차부터는 화요일 시작으로 계산
                    const baseDate = new Date('2025-03-25'); // 3월 25일 화요일부터 2주차 시작
                    weekStart = new Date(baseDate);
                    weekStart.setDate(baseDate.getDate() + (week - 2) * 7);
                    weekEnd = new Date(weekStart);
                    weekEnd.setDate(weekEnd.getDate() + 6);
                }

                startStr = weekStart.toLocaleDateString('ko-KR', { month: 'short', day: 'numeric' });
                endStr = weekEnd.toLocaleDateString('ko-KR', { month: 'short', day: 'numeric' });
                
                // 올스타 브레이크 주차 확인 (17주차)
                const isAllStarBreak = week === 17;
                const weekCellContent = isAllStarBreak ? `${week}주차 ⭐` : `${week}주차`;
                
                html += `
                    <tr>
                        <td class="week-cell">${weekCellContent}</td>
                        <td class="date-cell">${startStr} ~ ${endStr}</td>
                        ${teams.map(team => {
                            const teamAnalysis = weeklyAnalysisData.weeklyAnalysis[team];
                            const weekStats = teamAnalysis?.weeklyStats?.[week] || { 
                                games: 0, wins: 0, losses: 0, draws: 0, winRate: '0.0' 
                            };
                            // weekStats.winRate가 퍼센테이지인지 소수점인지 확인 후 적절히 변환
                            const winRateValue = parseFloat(weekStats.winRate);
                            const normalizedWinRate = winRateValue > 1 ? winRateValue / 100 : winRateValue;
                            const winRateClass = getWinRateClass(normalizedWinRate);
                            const totalGames = weekStats.wins + weekStats.losses + weekStats.draws;
                            
                            // 경기가 없는 경우 특별 처리
                            if (totalGames === 0) {
                                return `<td style="color: #999; font-size: var(--font-sm); padding: 8px; text-align: center;">-</td>`;
                            }
                            
                            return `
                                <td class="${winRateClass}" style="font-size: var(--font-sm); padding: 8px; line-height: 1.3; text-align: center;">
                                    <div style="font-weight: var(--font-weight-semibold); margin-bottom: 2px;">${weekStats.wins}-${weekStats.losses}-${weekStats.draws} (<span class="baseball-winrate-inline">${normalizedWinRate.toFixed(3)}</span>)</div>
                                    <div style="font-size: var(--font-xs); color: #666; margin-top: 2px;">${totalGames}경기</div>
                                </td>
                            `;
                        }).join('')}
                    </tr>`;
            }

            html += `</tbody></table></div>
            
            <!-- 설명 섹션 -->
            <div style="margin-top: 15px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">
                <div style="font-size: var(--font-base); font-weight: var(--font-weight-medium); margin-bottom: 8px; color: #495057;">📅 주차별 성적 설명</div>
                <div style="font-size: var(--font-sm); color: #6c757d; line-height: 1.5;">
                    <div style="margin-bottom: 6px;"><strong>올스타전:</strong> <span style="color: #ff9800; font-weight: var(--font-weight-semibold);">⭐ 7월 12일 (17주차)</span> - 1주차: 3월 22일~23일 개막 시리즈, 2주차 이후: 화요일~월요일 주간제</div>
                    <div><strong>승률 색상:</strong> <span style="background: rgba(34, 197, 94, 0.1); padding: 2px 6px; border-radius: 3px;">0.500 초과 (좋음)</span> <span style="background: rgba(234, 179, 8, 0.1); padding: 2px 6px; border-radius: 3px;">0.500 (보통)</span> <span style="background: rgba(239, 68, 68, 0.1); padding: 2px 6px; border-radius: 3px;">0.500 미만 (나쁨)</span></div>
                </div>
            </div>
            </tbody>
            </table>
            </div>`;
            
            document.getElementById('weeklyStatsContent').innerHTML = html;
        }

        // 게임별 기록 테이블 렌더링 (모든 팀 동시 표시)
        function renderGameByGameTable() {
            if (!gameRecordsData) return;

            const teams = ['LG', '한화', 'KIA', '삼성', 'KT', 'SSG', '롯데', '두산', 'NC', '키움'];
            
            // 최대 경기 수 계산
            const maxGames = Math.max(...teams.map(team => gameRecordsData[team]?.games.length || 0));
            
            let html = `
                <div class="table-scroll-wrapper">
                    <table class="all-teams-table">
                        <thead>
                            <tr>
                                <th>경기#</th>
                                ${teams.map(team => `<th class="team-header-column">${getTeamWithLogo(team, 'team-logo-small')}</th>`).join('')}
                            </tr>
                        </thead>
                        <tbody>`;

            // 각 경기별로 행 생성
            for (let gameNum = 1; gameNum <= maxGames; gameNum++) {
                // 5게임 단위로 미묘한 배경색 구분
                const isEveryFifthGame = gameNum % 5 === 0;
                const rowBgColor = isEveryFifthGame ? 'rgba(52, 73, 94, 0.02)' : 'transparent';
                const gameNumBgColor = isEveryFifthGame ? 'rgba(52, 73, 94, 0.08)' : '#f8f9fa';
                
                html += `<tr style="background: ${rowBgColor};">
                    <td class="game-number-cell" style="background: ${gameNumBgColor}; font-weight: var(--font-weight-bold);">${gameNum}</td>`;
                
                teams.forEach(team => {
                    const teamRecord = gameRecordsData[team];
                    const game = teamRecord?.games[gameNum - 1];
                    
                    if (game) {
                        // 현재 게임에서의 연승/연패 카운트 계산
                        const streakInfo = calculateStreakAtGame(teamRecord.games, gameNum - 1);
                        const streakNumber = streakInfo.count > 0 ? streakInfo.count : '';
                        
                        // 결과를 한글로 변환
                        const resultText = game.result === 'W' ? '승' : 
                                         game.result === 'L' ? '패' : 
                                         game.result === 'D' || game.result === 'T' ? '무' : game.result;
                        
                        // 무승부일 때 특별한 클래스 추가
                        const isDraw = game.result === 'D' || game.result === 'T';
                        const resultClass = isDraw ? 'result-letter draw-result' : 'result-letter';
                        
                        html += `
                        <td class="game-result-cell ${game.result === 'W' ? 'cell-win' : game.result === 'L' ? 'cell-loss' : 'cell-draw'}" 
                            title="${team} vs ${game.opponent} (${game.score}) - ${game.date}">
                            <div class="result-display">
                                ${streakNumber ? `<span class="combined-result">${streakNumber}${resultText}</span>` : `<span class="${resultClass}">${resultText}</span>`}
                            </div>
                        </td>`;
                    } else {
                        html += `<td class="game-result-cell cell-empty">-</td>`;
                    }
                });
                
                html += `</tr>`;
            }

            html += `
                        </tbody>
                    </table>
                </div>
                
                <!-- 설명 섹션 -->
                <div style="margin-top: 15px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">
                    <div style="font-size: var(--font-base); font-weight: var(--font-weight-medium); margin-bottom: 8px; color: #495057;">🎮 게임별 기록 설명</div>
                    <div style="font-size: var(--font-sm); color: #6c757d; line-height: 1.5;">
                        <div style="margin-bottom: 6px;"><strong>승리 (W):</strong> <span style="background: #d4fdd4; color: #1e6f1e; padding: 2px 4px; border-radius: 3px; font-weight: var(--font-weight-semibold);">녹색 배경</span></div>
                        <div style="margin-bottom: 6px;"><strong>패배 (L):</strong> <span style="background: #fdd4d4; color: #b91c1c; padding: 2px 4px; border-radius: 3px; font-weight: var(--font-weight-semibold);">빨간색 배경</span></div>
                        <div style="margin-bottom: 6px;"><strong>무승부 (D):</strong> <span style="background: #fef3c7; color: #92400e; padding: 2px 4px; border-radius: 3px; font-weight: var(--font-weight-semibold);">노란색 배경</span></div>
                        <div><strong>연승/연패 표시:</strong> 이어질 때마다 숫자로 표시 (예: 1승→2승→3승 또는 1패→2패→3패)</div>
                    </div>
                </div>`;

            document.getElementById('gameRecordsContent').innerHTML = html;
        }

        // 특정 게임에서의 연승/연패 카운트 계산
        function calculateStreakAtGame(games, gameIndex) {
            if (gameIndex < 0 || gameIndex >= games.length) {
                return { type: null, count: 0 };
            }
            
            const currentGame = games[gameIndex];
            if (currentGame.result === 'D') {
                return { type: null, count: 0 };
            }
            
            let count = 1;
            let streakType = currentGame.result;
            
            // 이전 게임들을 거슬러 올라가며 연속 기록 계산
            for (let i = gameIndex - 1; i >= 0; i--) {
                const prevGame = games[i];
                if (prevGame.result === streakType) {
                    count++;
                } else {
                    break;
                }
            }
            
            return { type: streakType, count: count };
        }

        // 2025년 대한민국 공휴일
        const koreaHolidays2025 = {
            '2025-01-01': '신정',
            '2025-01-28': '설날 연휴',
            '2025-01-29': '설날',
            '2025-01-30': '설날 연휴',
            '2025-03-01': '3.1절',
            '2025-05-05': '어린이날',
            '2025-05-13': '부처님 오신 날',
            '2025-06-06': '현충일',
            '2025-08-15': '광복절',
            '2025-09-06': '추석 연휴',
            '2025-09-07': '추석 연휴',
            '2025-09-08': '추석',
            '2025-09-09': '추석 연휴',
            '2025-10-03': '개천절',
            '2025-10-09': '한글날',
            '2025-12-25': '크리스마스'
        };

        // 날짜가 공휴일인지 확인하는 함수
        function getHolidayInfo(dateString) {
            const holiday = koreaHolidays2025[dateString];
            if (holiday) {
                const date = new Date(dateString);
                const dayOfWeek = date.getDay();
                const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;
                
                if (!isWeekend) {
                    return ` (${holiday})`;
                } else {
                    return ` 🎌`;
                }
            }
            return '';
        }

        // 팀별 상세 게임 기록 렌더링
        function renderTeamDetailedRecords() {
            if (!gameRecordsData) return;

            const teams = ['LG', '한화', 'KIA', '삼성', 'KT', 'SSG', '롯데', '두산', 'NC', '키움'];
            
            let html = `
            <div class="team-detailed-records">
                <div class="team-selector" style="text-align: center; margin-bottom: 25px;">
                    <h3 style="margin-bottom: 15px; color: #2d3748; font-size: var(--font-xl); font-weight: var(--font-weight-semibold);">📋 팀 선택</h3>
                    <div class="team-tabs" style="display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; padding: 15px; background: #f8f9fa; border-radius: 8px; max-width: 800px; margin: 0 auto; border: 1px solid #e9ecef;">
                        ${teams.map(team => 
                            `<button onclick="changeSelectedTeam('${team}')" 
                                class="team-tab ${team === currentSelectedTeam ? 'active' : ''}" 
                                style="padding: 8px 14px; font-size: var(--font-base); font-weight: var(--font-weight-medium); border: 1px solid ${team === currentSelectedTeam ? '#495057' : '#dee2e6'}; border-radius: 6px; background: ${team === currentSelectedTeam ? '#495057' : 'white'}; color: ${team === currentSelectedTeam ? 'white' : '#666'}; cursor: pointer; transition: all 0.2s ease; min-width: 50px;"
                                onmouseover="if(!this.classList.contains('active')) { this.style.background='#e9ecef'; this.style.borderColor='#495057'; this.style.color='#495057'; }"
                                onmouseout="if(!this.classList.contains('active')) { this.style.background='white'; this.style.borderColor='#dee2e6'; this.style.color='#666'; }">
                                ${team}
                            </button>`
                        ).join('')}
                    </div>
                </div>`;

            const teamRecord = gameRecordsData[currentSelectedTeam];
            if (teamRecord) {
                // 최근 10경기 기록
                const recentGames = teamRecord.games.slice(-10);
                const recent10Record = recentGames.reduce((acc, game) => {
                    if (game.result === 'W') acc.wins++;
                    else if (game.result === 'L') acc.losses++;
                    else acc.draws++;
                    return acc;
                }, { wins: 0, losses: 0, draws: 0 });

                // 전체 기록
                const totalRecord = teamRecord.games.reduce((acc, game) => {
                    if (game.result === 'W') acc.wins++;
                    else if (game.result === 'L') acc.losses++;
                    else acc.draws++;
                    return acc;
                }, { wins: 0, losses: 0, draws: 0 });

                const winRate = totalRecord.wins > 0 ? (totalRecord.wins / (totalRecord.wins + totalRecord.losses)).toFixed(3) : '0.000';

                html += `
                <div class="selected-team-details">
                    <h4 style="text-align: center; margin-bottom: 20px; color: #2d3748; font-size: var(--font-xl); font-weight: var(--font-weight-semibold);">${currentSelectedTeam} 상세 기록</h4>
                    
                    <!-- 팀 통계 요약 (한줄 레이아웃) -->
                    <div class="team-stats-summary" style="margin-bottom: 20px; background: #f8f9fa; padding: 15px 20px; border-radius: 8px; border: 1px solid #e9ecef;">
                        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px;">
                            <div style="display: flex; flex-direction: column; align-items: center; gap: 4px;">
                                <span style="font-size: var(--font-sm); color: #718096; font-weight: var(--font-weight-medium);">총경기</span>
                                <span style="font-size: var(--font-lg); font-weight: var(--font-weight-bold); color: #2d3748;">${teamRecord.games.length}</span>
                            </div>
                            <div style="display: flex; flex-direction: column; align-items: center; gap: 4px;">
                                <span style="font-size: var(--font-sm); color: #718096; font-weight: var(--font-weight-medium);">전체성적</span>
                                <span style="font-size: var(--font-lg); font-weight: var(--font-weight-bold); color: #2d3748;">${totalRecord.wins}-${totalRecord.losses}-${totalRecord.draws}</span>
                            </div>
                            <div style="display: flex; flex-direction: column; align-items: center; gap: 4px;">
                                <span style="font-size: var(--font-sm); color: #718096; font-weight: var(--font-weight-medium);">승률</span>
                                <span style="font-size: var(--font-lg); font-weight: var(--font-weight-bold); color: #3182ce;">${winRate}</span>
                            </div>
                            <div style="display: flex; flex-direction: column; align-items: center; gap: 4px;">
                                <span style="font-size: var(--font-sm); color: #718096; font-weight: var(--font-weight-medium);">최근10경기</span>
                                <span style="font-size: var(--font-lg); font-weight: var(--font-weight-bold); color: #2d3748;">${recent10Record.wins}-${recent10Record.losses}-${recent10Record.draws}</span>
                            </div>
                            <div style="display: flex; flex-direction: column; align-items: center; gap: 4px;">
                                <span style="font-size: var(--font-sm); color: #718096; font-weight: var(--font-weight-medium);">현재연속</span>
                                <span style="font-size: var(--font-lg); font-weight: var(--font-weight-bold);" class="${teamRecord.currentStreak.type === 'W' ? 'win-color' : teamRecord.currentStreak.type === 'L' ? 'loss-color' : ''}">
                                    ${teamRecord.currentStreak.type === 'W' ? `${teamRecord.currentStreak.count}연승` : 
                                      teamRecord.currentStreak.type === 'L' ? `${teamRecord.currentStreak.count}연패` : '없음'}
                                </span>
                            </div>
                            <div style="display: flex; flex-direction: column; align-items: center; gap: 4px;">
                                <span style="font-size: var(--font-sm); color: #718096; font-weight: var(--font-weight-medium);">최장연승</span>
                                <span style="font-size: var(--font-lg); font-weight: var(--font-weight-bold);" class="win-color">${teamRecord.longestWinStreak}</span>
                            </div>
                            <div style="display: flex; flex-direction: column; align-items: center; gap: 4px;">
                                <span style="font-size: var(--font-sm); color: #718096; font-weight: var(--font-weight-medium);">최장연패</span>
                                <span style="font-size: var(--font-lg); font-weight: var(--font-weight-bold);" class="loss-color">${teamRecord.longestLoseStreak}</span>
                            </div>
                        </div>
                    </div>

                    <!-- 상세 게임 기록 테이블 -->
                    <div class="detailed-games-section">
                        <h4 style="text-align: center; margin: 25px 0 20px 0; color: #2d3748; font-size: var(--font-xl); font-weight: var(--font-weight-semibold);">전체 게임 기록</h4>
                        <div class="table-scroll-wrapper">
                            <table class="detailed-game-table" id="detailedGameTable">
                                <thead>
                                    <tr>
                                        <th class="sortable" data-column="gameNumber">경기#</th>
                                        <th class="sortable" data-column="date">날짜</th>
                                        <th class="sortable" data-column="opponent">상대팀</th>
                                        <th class="sortable" data-column="venue">홈/원정</th>
                                        <th>스코어</th>
                                        <th class="sortable" data-column="result">결과</th>
                                        <th class="sortable" data-column="runs_scored">득점</th>
                                        <th class="sortable" data-column="runs_allowed">실점</th>
                                        <th class="sortable" data-column="scoreDiff">득실차</th>
                                    </tr>
                                </thead>
                                <tbody id="detailedGameTableBody">`;

                teamRecord.games.forEach((game, index) => {
                    const scoreDiff = game.runs_scored - game.runs_allowed;
                    const scoreDiffText = scoreDiff > 0 ? `+${scoreDiff}` : scoreDiff.toString();
                    
                    // 날짜에서 요일 계산 (주말/평일 구분)
                    const gameDate = new Date(game.date);
                    const dayOfWeek = gameDate.getDay(); // 0=일요일, 6=토요일
                    const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;
                    
                    // 공휴일 정보 추가
                    const holidayInfo = getHolidayInfo(game.date);
                    const displayDate = game.date + holidayInfo;
                    const isHoliday = koreaHolidays2025[game.date];
                    
                    // 날짜 클래스 결정 (공휴일 > 주말 > 평일 순서)
                    let dateClass = 'weekday-date';
                    if (isHoliday) {
                        dateClass = 'holiday-date';
                    } else if (isWeekend) {
                        dateClass = 'weekend-date';
                    }
                    
                    html += `
                        <tr class="${game.result === 'W' ? 'win-row' : game.result === 'L' ? 'loss-row' : 'draw-row'}">
                            <td class="game-num-cell">${game.gameNumber}</td>
                            <td class="date-cell ${dateClass}">${displayDate}</td>
                            <td class="opponent-cell">${getTeamWithLogo(game.opponent)}</td>
                            <td class="venue-cell ${game.isHome ? 'home-venue' : 'away-venue'}">${game.isHome ? '홈' : '원정'}</td>
                            <td class="score-cell">${game.score}</td>
                            <td class="result-cell">
                                <span class="result-badge ${game.result.toLowerCase()}">${
                                    game.result === 'W' ? '승' : game.result === 'L' ? '패' : '무'
                                }</span>
                            </td>
                            <td class="runs-cell">${game.runs_scored}</td>
                            <td class="runs-cell">${game.runs_allowed}</td>
                            <td class="diff-cell ${getRunDiffClass(scoreDiff)}">${scoreDiffText}</td>
                        </tr>`;
                });

                html += `
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- 설명 섹션 -->
                        <div style="margin-top: 15px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">
                            <div style="font-size: var(--font-base); font-weight: var(--font-weight-medium); margin-bottom: 8px; color: #495057;">📋 게임 기록 설명</div>
                            <div style="font-size: var(--font-sm); color: #6c757d; line-height: 1.5;">
                                <div style="margin-bottom: 6px;"><strong>상대팀:</strong> 팀 로고와 함께 표시</div>
                                <div style="margin-bottom: 6px;"><strong>홈/원정:</strong> <span style="color: #2563eb; font-weight: var(--font-weight-semibold);">홈</span> (파란색), <span style="color: #dc2626; font-weight: var(--font-weight-semibold);">원정</span> (빨간색)</div>
                                <div style="margin-bottom: 6px;"><strong>날짜:</strong> <span style="color: #1f2937;">평일</span> (검은색), <span style="color: #dc2626; font-weight: var(--font-weight-semibold);">주말</span> (빨간색)</div>
                                <div><strong>결과:</strong> 승리/패배/무승부에 따른 행 색상 구분</div>
                            </div>
                        </div>
                    </div>
                </div>`;
            }

            html += `</div>`;
            document.getElementById('teamDetailedRecordsContent').innerHTML = html;
            
            // 정렬 기능 초기화
            if (teamRecord) {
                initializeDetailedTableSorting();
            }
        }

        // 팀별 상세 테이블 정렬 기능 초기화
        function initializeDetailedTableSorting() {
            const table = document.getElementById('detailedGameTable');
            const headers = table.querySelectorAll('th.sortable');
            
            headers.forEach(header => {
                header.addEventListener('click', () => {
                    const column = header.dataset.column;
                    sortDetailedTable(column);
                });
            });
        }

        // 팀별 상세 테이블 정렬 함수
        function sortDetailedTable(column) {
            const table = document.getElementById('detailedGameTable');
            const tbody = table.querySelector('tbody');
            const rows = Array.from(tbody.querySelectorAll('tr'));
            
            // 현재 정렬 방향 확인
            const isAscending = table.dataset.sortDirection !== 'asc';
            table.dataset.sortDirection = isAscending ? 'asc' : 'desc';
            
            // 헤더 업데이트 (화살표 제거)
            table.querySelectorAll('th.sortable').forEach(th => {
                th.textContent = th.textContent.replace(/\s[↑↓↕️]/g, '');
            });
            const currentHeader = table.querySelector(`th[data-column="${column}"]`);
            currentHeader.textContent = currentHeader.textContent.replace(/\s[↑↓↕️]/g, '');
            
            // 행 정렬
            rows.sort((a, b) => {
                let aVal, bVal;
                
                switch(column) {
                    case 'gameNumber':
                        aVal = parseInt(a.querySelector('.game-num-cell').textContent);
                        bVal = parseInt(b.querySelector('.game-num-cell').textContent);
                        break;
                    case 'date':
                        aVal = new Date(a.querySelector('.date-cell').textContent);
                        bVal = new Date(b.querySelector('.date-cell').textContent);
                        break;
                    case 'opponent':
                        aVal = a.querySelector('.opponent-cell').textContent;
                        bVal = b.querySelector('.opponent-cell').textContent;
                        break;
                    case 'venue':
                        aVal = a.querySelector('.venue-cell').textContent;
                        bVal = b.querySelector('.venue-cell').textContent;
                        break;
                    case 'result':
                        aVal = a.querySelector('.result-badge').textContent;
                        bVal = b.querySelector('.result-badge').textContent;
                        // 승 > 무 > 패 순서로 정렬
                        const resultOrder = {'승': 3, '무': 2, '패': 1};
                        aVal = resultOrder[aVal] || 0;
                        bVal = resultOrder[bVal] || 0;
                        break;
                    case 'runs_scored':
                        aVal = parseInt(a.querySelectorAll('.runs-cell')[0].textContent);
                        bVal = parseInt(b.querySelectorAll('.runs-cell')[0].textContent);
                        break;
                    case 'runs_allowed':
                        aVal = parseInt(a.querySelectorAll('.runs-cell')[1].textContent);
                        bVal = parseInt(b.querySelectorAll('.runs-cell')[1].textContent);
                        break;
                    case 'scoreDiff':
                        const aDiff = a.querySelector('.diff-cell').textContent.replace('+', '');
                        const bDiff = b.querySelector('.diff-cell').textContent.replace('+', '');
                        aVal = parseInt(aDiff);
                        bVal = parseInt(bDiff);
                        break;
                    default:
                        aVal = a.cells[0].textContent;
                        bVal = b.cells[0].textContent;
                }
                
                if (aVal < bVal) return isAscending ? -1 : 1;
                if (aVal > bVal) return isAscending ? 1 : -1;
                return 0;
            });
            
            // 정렬된 행들을 테이블에 다시 추가
            rows.forEach(row => tbody.appendChild(row));
        }

        // 승률에 따른 CSS 클래스 계산 (0.xxx 형식 기준)
        function getWinRateClass(winRate) {
            if (winRate > 0.55) return 'positive';     // 0.550 초과 - 좋음
            if (winRate < 0.45) return 'negative';     // 0.450 미만 - 나쁨  
            return 'neutral';                          // 0.450-0.550 - 보통
        }
        
        // 레거시 지원용 (0.xxx 형식 기준)
        function getWinRateColor(winRate) {
            if (winRate > 0.55) return 'rgba(34, 197, 94, 0.1)';   // positive와 동일
            if (winRate < 0.45) return 'rgba(239, 68, 68, 0.1)';   // negative와 동일
            return 'rgba(234, 179, 8, 0.1)';                       // neutral과 동일
        }

        // 간단한 테스트 함수
        var fixSortToggle = true; // true: 연승순, false: 연패순
        
        window.fixedSort = function() {
            // 모든 자동 업데이트 함수들을 완전히 차단
            window.renderDashboard = function() { console.log('renderDashboard 차단됨'); };
            window.loadDashboardData = function() { console.log('loadDashboardData 차단됨'); };
            window.renderFullStandings = function() { console.log('renderFullStandings 차단됨'); };
            
            // 모든 타이머도 제거
            for (let i = 1; i < 99999; i++) window.clearTimeout(i);
            for (let i = 1; i < 99999; i++) window.clearInterval(i);
            
            const tbody = document.getElementById('fullStandingsBody');
            const rows = Array.from(tbody.children);
            
            // 정렬할 팀 데이터 생성
            const teams = [
                {name: '한화', streak: '4W', value: 1004},
                {name: 'KIA', streak: '3W', value: 1003},
                {name: 'LG', streak: '1W', value: 1001},
                {name: '두산', streak: '1W', value: 1001},
                {name: '키움', streak: '1W', value: 1001},
                {name: 'SSG', streak: '1L', value: -1},
                {name: 'KT', streak: '1L', value: -1},
                {name: 'NC', streak: '1L', value: -1},
                {name: '삼성', streak: '5L', value: -5},
                {name: '롯데', streak: '6L', value: -6}
            ];
            
            if (fixSortToggle) {
                teams.sort((a, b) => b.value - a.value); // 연승 우선
            } else {
                teams.sort((a, b) => a.value - b.value); // 연패 우선
            }
            
            // 기존 행들을 팀 이름으로 매핑
            const rowMap = {};
            rows.forEach(row => {
                const teamName = row.cells[1].textContent.trim();
                rowMap[teamName] = row.cloneNode(true);
            });
            
            // 정렬된 순서로 테이블 재구성
            tbody.innerHTML = '';
            teams.forEach((team, index) => {
                const row = rowMap[team.name];
                if (row) {
                    row.cells[0].innerHTML = `<strong>${index + 1}</strong>`;
                    tbody.appendChild(row);
                }
            });
            
            alert(`강제 정렬 완료! 1위: ${teams[0].name} (${teams[0].streak})`);
            fixSortToggle = !fixSortToggle;
        }

        // 연승/연패로 정렬 - 데이터 레벨에서 정렬
        var streakSortMode = 0; // 0: 순위순, 1: 연승순, 2: 연패순
        var isCustomSorted = false; // 사용자 정렬 상태 추적
        
        window.sortByStreakNew = function() {
            if (!dashboardData || !dashboardData.standings) {
                alert('데이터가 로드되지 않았습니다');
                return;
            }
            
            // 다른 렌더링 함수들을 임시로 비활성화
            const originalRenderDashboard = window.renderDashboard;
            const originalLoadDashboardData = window.loadDashboardData;
            
            // 원본 데이터 백업 (첫 호출시에만)
            if (!dashboardData.originalStandings) {
                dashboardData.originalStandings = [...dashboardData.standings];
            }
            
            // 현재 데이터 상태 디버그
            console.log('정렬 전 데이터:', dashboardData.standings.map(t => `${t.team_name}(${t.current_streak})`));
            
            streakSortMode = (streakSortMode + 1) % 3;
            console.log('🔢 현재 streakSortMode:', streakSortMode);
            
            if (streakSortMode === 0) {
                // 원래 순위 순서로 복원
                dashboardData.standings = [...dashboardData.originalStandings];
                isCustomSorted = false;
                console.log('순위 순서로 복원');
            } else if (streakSortMode === 1) {
                // 연승 우선 정렬 (승팀 → 패팀 순서)
                console.log('🏆 연승 우선 정렬 실행');
                dashboardData.standings.sort((a, b) => {
                    const aMatch = a.current_streak.match(/(\d+)([WL])/);
                    const bMatch = b.current_streak.match(/(\d+)([WL])/);
                    
                    if (!aMatch || !bMatch) return 0;
                    
                    const aNum = parseInt(aMatch[1]);
                    const bNum = parseInt(bMatch[1]);
                    const aType = aMatch[2];
                    const bType = bMatch[2];
                    
                    // 승 vs 패: 승이 항상 앞
                    if (aType === 'W' && bType === 'L') return -1;
                    if (aType === 'L' && bType === 'W') return 1;
                    
                    // 승 vs 승: 연승 수가 많은 순
                    if (aType === 'W' && bType === 'W') {
                        return bNum - aNum;
                    }
                    
                    // 패 vs 패: 연패 수가 적은 순
                    if (aType === 'L' && bType === 'L') {
                        return aNum - bNum;
                    }
                    
                    return 0;
                });
                
                // 정렬 후 순위 재배정
                dashboardData.standings.forEach((team, index) => {
                    team.rank = index + 1;
                });
                
                isCustomSorted = true;
                console.log('정렬 후 데이터:', dashboardData.standings.map(t => `${t.rank}.${t.team_name}(${t.current_streak})`));
                console.log('연승 우선 정렬 완료: ' + dashboardData.standings.slice(0,3).map(t => t.team_name).join(', '));
            } else {
                // 연패 우선 정렬 (패팀 → 승팀 순서)
                console.log('💀 연패 우선 정렬 실행');
                dashboardData.standings.sort((a, b) => {
                    const aMatch = a.current_streak.match(/(\d+)([WL])/);
                    const bMatch = b.current_streak.match(/(\d+)([WL])/);
                    
                    if (!aMatch || !bMatch) return 0;
                    
                    const aNum = parseInt(aMatch[1]);
                    const bNum = parseInt(bMatch[1]);
                    const aType = aMatch[2];
                    const bType = bMatch[2];
                    
                    // 패 vs 승: 패가 항상 앞
                    if (aType === 'L' && bType === 'W') return -1;
                    if (aType === 'W' && bType === 'L') return 1;
                    
                    // 패 vs 패: 연패 수가 많은 순
                    if (aType === 'L' && bType === 'L') {
                        return bNum - aNum;
                    }
                    
                    // 승 vs 승: 연승 수가 많은 순 (연패 우선이어도 승팀끼리는 연승 많은 순)
                    if (aType === 'W' && bType === 'W') {
                        return bNum - aNum;
                    }
                    
                    return 0;
                });
                
                // 정렬 후 순위 재배정
                dashboardData.standings.forEach((team, index) => {
                    team.rank = index + 1;
                });
                
                isCustomSorted = true;
                console.log('연패 우선 정렬 완료: ' + dashboardData.standings.slice(0,3).map(t => t.team_name).join(', '));
            }
            
            // 다른 함수들이 실행되지 않도록 무력화
            window.renderDashboard = function() { console.log('renderDashboard 무력화됨'); };
            window.loadDashboardData = function() { console.log('loadDashboardData 무력화됨'); };
            
            // 테이블만 다시 렌더링
            try {
                renderFullStandings();
                console.log('✅ 정렬된 테이블 렌더링 완료');
            } catch (error) {
                console.error('renderFullStandings 에러:', error);
            }
            
            // 정렬 상태 유지를 위해 복원 시간을 30초로 연장
            setTimeout(() => {
                // 커스텀 정렬 상태가 아닐 때만 복원
                if (!isCustomSorted) {
                    window.renderDashboard = originalRenderDashboard;
                    window.loadDashboardData = originalLoadDashboardData;
                    console.log('원래 함수들 복원');
                } else {
                    console.log('커스텀 정렬 상태 유지 중...');
                }
            }, 30000);
        }

        // 전체 순위표 (모든 지표 포함)
        function renderFullStandings() {
            const tbody = document.getElementById('fullStandingsBody');
            tbody.innerHTML = '';

            dashboardData.standings.forEach((team, index) => {
                // 해당 팀의 상세 데이터 찾기
                const teamSummary = dashboardData.teamSummaries?.find(t => t.team_name === team.team_name);
                const pythagorean = dashboardData.pythagoreanAnalysis?.find(t => t.team_name === team.team_name);
                const oneRun = dashboardData.oneRunGames?.find(t => t.team_name === team.team_name);
                const homeAway = dashboardData.homeAwayStats?.find(t => t.team_name === team.team_name);
                const streak = dashboardData.streakAnalysis?.find(t => t.team_name === team.team_name);

                const row = document.createElement('tr');
                // row.className = index < 3 ? `rank-${index + 1}` : '';
                
                // 연승/연패 색상 클래스 결정
                let streakClass = 'streak-neutral';
                let streakNum = 0;
                if (team.current_streak) {
                    const match = team.current_streak.match(/(\d+)([WL])/);
                    if (match) {
                        streakNum = parseInt(match[1]);
                        const streakType = match[2];
                        if (streakType === 'W') {
                            if (streakNum >= 3) streakClass = 'streak-hot';
                            else streakClass = 'streak-warm';
                        } else if (streakType === 'L') {
                            if (streakNum >= 3) streakClass = 'streak-cold';
                            else streakClass = 'streak-cool';
                        }
                    }
                }

                row.innerHTML = `
                    <td class="${team.rank <= 3 ? `rank-${team.rank}` : ''}"><strong>${team.rank}</strong></td>
                    <td class="team-name">${getTeamWithLogo(team.team_name)}</td>
                    <td>${team.games_played}</td>
                    <td>${144 - team.games_played}</td>
                    <td>${team.wins}</td>
                    <td>${team.draws}</td>
                    <td>${team.losses}</td>
                    <td><strong>${team.win_rate}</strong></td>
                    <td>${team.games_behind}</td>
                    <td>${team.runs_scored}</td>
                    <td>${team.runs_allowed}</td>
                    <td class="${getRunDiffClass(team.run_differential)}">${team.run_differential}</td>
                    <td>${pythagorean ? pythagorean.expected_win_rate : '-'}</td>
                    <td class="${pythagorean && parseFloat(pythagorean.luck_factor) > 0.02 ? 'positive' : pythagorean && parseFloat(pythagorean.luck_factor) < -0.02 ? 'negative' : 'neutral'}">${pythagorean ? pythagorean.luck_factor : '-'}</td>
                    <td class="${oneRun ? getWinRateClass(parseFloat(oneRun.win_rate)) : ''}">${oneRun ? oneRun.win_rate : '-'}</td>
                    <td>${homeAway ? homeAway.home_win_rate : '-'}</td>
                    <td>${homeAway ? homeAway.away_win_rate : '-'}</td>
                    <td class="${homeAway && parseFloat(homeAway.home_advantage) > 0.05 ? 'positive' : homeAway && parseFloat(homeAway.home_advantage) < -0.05 ? 'negative' : 'neutral'}">${homeAway ? homeAway.home_advantage : '-'}</td>
                    <td class="${streakClass}">${team.current_streak}</td>
                    <td>${streak ? streak.max_win_streak : '-'}</td>
                    <td>${streak ? streak.max_lose_streak : '-'}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // 피타고리안 전체 분석
        function renderPythagoreanFullAnalysis() {
            const tbody = document.getElementById('pythagoreanBody');
            tbody.innerHTML = '';

            // 팀 순위 기준으로 정렬
            const sortedTeams = dashboardData.pythagoreanAnalysis.sort((a, b) => {
                const teamA = dashboardData.standings.find(t => t.team_name === a.team_name);
                const teamB = dashboardData.standings.find(t => t.team_name === b.team_name);
                const rankA = teamA ? teamA.rank : 999;
                const rankB = teamB ? teamB.rank : 999;
                return rankA - rankB;
            });
            
            sortedTeams.forEach((team, index) => {
                const teamData = dashboardData.standings.find(t => t.team_name === team.team_name);
                const rank = teamData ? teamData.rank : (index + 1);
                const avgScored = teamData ? (teamData.runs_scored / teamData.games_played).toFixed(2) : '-';
                const avgAllowed = teamData ? (teamData.runs_allowed / teamData.games_played).toFixed(2) : '-';

                const row = document.createElement('tr');
                const luckClass = parseFloat(team.luck_factor) > 0.02 ? 'positive' : 
                                 parseFloat(team.luck_factor) < -0.02 ? 'negative' : 'neutral';
                
                row.innerHTML = `
                    <td class="rank-${rank <= 3 ? rank : 'other'}" style="font-weight: var(--font-weight-bold); text-align: center;">${rank}</td>
                    <td class="team-name">${getTeamWithLogo(team.team_name)}</td>
                    <td><strong>${team.actual_win_rate}</strong></td>
                    <td>${team.expected_win_rate}</td>
                    <td class="${luckClass}"><strong>${team.luck_factor}</strong></td>
                    <td class="${luckClass}">${team.luck_status}</td>
                    <td>${teamData ? teamData.runs_scored : '-'}</td>
                    <td>${teamData ? teamData.runs_allowed : '-'}</td>
                    <td>${avgScored}</td>
                    <td>${avgAllowed}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // 클러치 상황 전체 분석
        async function renderClutchFullAnalysis() {
            try {
                const response = await fetch('magic-number/data/clutch-analysis.json');
                const clutchData = await response.json();
                
                const tbody = document.getElementById('clutchBody');
                tbody.innerHTML = '';

                // 팀 순위 기준으로 정렬
                const teams = Object.keys(clutchData.clutchAnalysis).sort((a, b) => {
                    const teamA = dashboardData.standings.find(t => t.team_name === a);
                    const teamB = dashboardData.standings.find(t => t.team_name === b);
                    const rankA = teamA ? teamA.rank : 999;
                    const rankB = teamB ? teamB.rank : 999;
                    return rankA - rankB;
                });

                teams.forEach((teamName, index) => {
                    const team = clutchData.clutchAnalysis[teamName];
                    // 순위는 dashboardData.standings에서 가져오거나 클러치 순서로 표시
                    const teamData = dashboardData ? dashboardData.standings.find(t => t.team_name === teamName) : null;
                    const rank = teamData ? teamData.rank : (index + 1);
                    
                    const row = document.createElement('tr');
                    
                    const oneRunWinRateValue = parseFloat(team.oneRunWinRate);
                    const normalizedOneRunRate = oneRunWinRateValue > 1 ? oneRunWinRateValue / 100 : oneRunWinRateValue;
                    const oneRunClass = normalizedOneRunRate > 0.55 ? 'positive' : 
                                       normalizedOneRunRate < 0.45 ? 'negative' : 'neutral';
                    const clutchClass = parseFloat(team.clutchIndex) > 0.55 ? 'positive' : 
                                       parseFloat(team.clutchIndex) < 0.45 ? 'negative' : 'neutral';
                    
                    row.innerHTML = `
                        <td class="rank-${rank <= 3 ? rank : 'other'}" style="font-weight: var(--font-weight-bold); text-align: center;">${rank}</td>
                        <td class="team-name">${getTeamWithLogo(teamName)}</td>
                        <td>${team.oneRunWins}</td>
                        <td>${team.oneRunLosses}</td>
                        <td class="${oneRunClass}"><strong>${normalizedOneRunRate.toFixed(3)}</strong></td>
                        <td>${team.blowoutWins}</td>
                        <td>${team.blowoutLosses}</td>
                        <td>${team.shutoutWins}</td>
                        <td>${team.shutoutLosses}</td>
                        <td class="${clutchClass}"><strong>${team.clutchIndex}</strong></td>
                    `;
                    tbody.appendChild(row);
                });
            } catch (error) {
                console.error('클러치 분석 데이터 로드 실패:', error);
                document.getElementById('clutchBody').innerHTML = '<tr><td colspan="10" style="text-align: center; padding: 20px; color: #e74c3c;">클러치 분석 데이터를 로드할 수 없습니다.</td></tr>';
            }
        }

        // 홈/원정 전체 분석
        async function renderHomeAwayFullAnalysis() {
            try {
                const response = await fetch('magic-number/data/home-away-analysis.json');
                const homeAwayData = await response.json();
                
                const tbody = document.getElementById('homeAwayBody');
                tbody.innerHTML = '';

                // 팀 순위 기준으로 정렬
                const teams = Object.keys(homeAwayData.homeAwayAnalysis).sort((a, b) => {
                    const teamA = dashboardData.standings.find(t => t.team_name === a);
                    const teamB = dashboardData.standings.find(t => t.team_name === b);
                    const rankA = teamA ? teamA.rank : 999;
                    const rankB = teamB ? teamB.rank : 999;
                    return rankA - rankB;
                });

                const stadiumMap = {
                    'KIA': '광주 챔피언스필드',
                    'LG': '서울 잠실야구장',
                    '두산': '서울 잠실야구장',
                    '삼성': '대구 삼성라이온즈파크',
                    'SSG': '인천 SSG랜더스필드',
                    'KT': '수원 KT위즈파크',
                    '한화': '대전 한화생명이글스파크',
                    'NC': '창원 NC파크',
                    '롯데': '부산 사직야구장',
                    '키움': '서울 고척스카이돔'
                };

                teams.forEach((teamName, index) => {
                    const team = homeAwayData.homeAwayAnalysis[teamName];
                    const row = document.createElement('tr');
                    
                    // dashboardData에서 실제 순위 찾기
                    const teamData = dashboardData ? dashboardData.standings.find(t => t.team_name === teamName) : null;
                    const rank = teamData ? teamData.rank : (index + 1);
                    
                    const homeAdvantageValue = parseFloat(team.homeAdvantage);
                    const normalizedAdvantage = Math.abs(homeAdvantageValue) > 1 ? homeAdvantageValue / 100 : homeAdvantageValue;
                    const homeAdvantageClass = normalizedAdvantage > 0.05 ? 'positive' : 
                                              normalizedAdvantage < -0.05 ? 'negative' : 'neutral';
                    
                    const homeWinRateValue = parseFloat(team.home.winRate);
                    const normalizedHomeRate = homeWinRateValue > 1 ? homeWinRateValue / 100 : homeWinRateValue;
                    const awayWinRateValue = parseFloat(team.away.winRate);
                    const normalizedAwayRate = awayWinRateValue > 1 ? awayWinRateValue / 100 : awayWinRateValue;
                    
                    const homeWinRateClass = normalizedHomeRate > 0.55 ? 'positive' : 
                                            normalizedHomeRate < 0.45 ? 'negative' : 'neutral';
                    const awayWinRateClass = normalizedAwayRate > 0.55 ? 'positive' : 
                                            normalizedAwayRate < 0.45 ? 'negative' : 'neutral';
                    
                    row.innerHTML = `
                        <td class="rank-${rank <= 3 ? rank : 'other'}" style="font-weight: var(--font-weight-bold); text-align: center;">${rank}</td>
                        <td class="team-name">${getTeamWithLogo(teamName)}</td>
                        <td>${team.home.games}</td>
                        <td>${team.home.wins}</td>
                        <td>${team.home.losses}</td>
                        <td class="${homeWinRateClass} baseball-winrate-cell"><strong>${normalizedHomeRate.toFixed(3)}</strong></td>
                        <td>${team.away.games}</td>
                        <td>${team.away.wins}</td>
                        <td>${team.away.losses}</td>
                        <td class="${awayWinRateClass} baseball-winrate-cell"><strong>${normalizedAwayRate.toFixed(3)}</strong></td>
                        <td class="${homeAdvantageClass} baseball-winrate-cell"><strong>${normalizedAdvantage.toFixed(3)}</strong></td>
                        <td style="font-size: var(--font-sm);">${stadiumMap[teamName] || '-'}</td>
                    `;
                    tbody.appendChild(row);
                });
            } catch (error) {
                console.error('홈/원정 분석 데이터 로드 실패:', error);
                document.getElementById('homeAwayBody').innerHTML = '<tr><td colspan="12" style="text-align: center; padding: 20px; color: #e74c3c;">홈/원정 분석 데이터를 로드할 수 없습니다.</td></tr>';
            }
        }

        // 상대전적 매트릭스
        async function renderHeadToHeadMatrix() {
            const container = document.getElementById('matrixContent');
            
            // kbo-records.json 데이터 로드
            let recordsData = null;
            try {
                const response = await fetch('magic-number/data/kbo-records.json');
                recordsData = await response.json();
                console.log('✅ kbo-records.json 로드 완료');
            } catch (error) {
                console.error('❌ kbo-records.json 로드 실패:', error);
            }
            
            // 순위 순서대로 팀 정렬
            const rankedTeams = dashboardData.standings.map(team => team.team_name);
            
            let html = '<div>';
            
            // 전체 매트릭스만 표시
            html += '<table class="matrix-table"><thead><tr><th>vs</th>';
            rankedTeams.forEach(team => {
                html += `<th><strong>${getTeamWithLogo(team, 'team-logo-small')}</strong></th>`;
            });
            html += '</tr></thead><tbody>';
            
            rankedTeams.forEach(team1 => {
                html += `<tr><th><strong>${getTeamWithLogo(team1, 'team-logo-small')}</strong></th>`;
                rankedTeams.forEach(team2 => {
                    html += renderMatrixCell(team1, team2, recordsData);
                });
                html += '</tr>';
            });
            html += '</tbody></table>';
            
            
            html += '</div>';
            html += '</div>';
            container.innerHTML = html;
        }

        // 팀간 잔여경기수 매트릭스 렌더링
        async function renderRemainingGamesMatrix() {
            const container = document.getElementById('remainingGamesContent');
            
            // kbo-records.json 데이터 로드
            let recordsData = null;
            try {
                const response = await fetch('magic-number/data/kbo-records.json');
                recordsData = await response.json();
                console.log('✅ 잔여경기수용 kbo-records.json 로드 완료');
            } catch (error) {
                console.error('❌ 잔여경기수용 kbo-records.json 로드 실패:', error);
            }
            
            // 순위 순서대로 팀 정렬
            const rankedTeams = dashboardData.standings.map(team => team.team_name);
            
            let html = '<div>';
            
            // 잔여경기수 매트릭스
            html += '<table class="matrix-table"><thead><tr><th>vs</th>';
            
            rankedTeams.forEach(team => {
                html += `<th><strong>${getTeamWithLogo(team, 'team-logo-small')}</strong></th>`;
            });
            html += '</tr></thead><tbody>';
            
            // 잔여경기수 계산 및 표시
            rankedTeams.forEach(team1 => {
                html += `<tr><th><strong>${getTeamWithLogo(team1, 'team-logo-small')}</strong></th>`;
                rankedTeams.forEach(team2 => {
                    html += renderRemainingGamesCell(team1, team2, recordsData);
                });
                html += '</tr>';
            });
            html += '</tbody></table>';
            
            // 잔여경기수 범례 추가
            html += `
                <div style="margin-top: 15px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">
                    <div style="font-size: var(--font-base); font-weight: var(--font-weight-medium); margin-bottom: 8px; color: #495057;">📊 잔여경기수 범례</div>
                    <div style="display: flex; gap: 20px; flex-wrap: wrap; font-size: var(--font-sm);">
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <div style="width: 20px; height: 20px; background: rgba(156, 163, 175, 0.6); border-radius: 3px;"></div>
                            <span>0경기 (경기 종료)</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <div style="width: 20px; height: 20px; background: rgba(249, 115, 22, 0.6); border-radius: 3px;"></div>
                            <span>1-3경기 남음</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <div style="width: 20px; height: 20px; background: rgba(234, 179, 8, 0.6); border-radius: 3px;"></div>
                            <span>4-6경기 남음</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <div style="width: 20px; height: 20px; background: rgba(34, 197, 94, 0.6); border-radius: 3px;"></div>
                            <span>7경기 이상 남음</span>
                        </div>
                    </div>
                    <div style="font-size: var(--font-xs); color: #6c757d; margin-top: 8px;">
                        * KBO 정규시즌: 각 팀당 총 16경기 (홈 8경기, 원정 8경기)
                    </div>
                </div>
            `;
            
            html += '</div>';
            container.innerHTML = html;
        }
        
        // 매트릭스 셀 렌더링 함수 (kbo-records.json 데이터 사용)
        function renderMatrixCell(team1, team2, recordsData) {
            if (team1 === team2) {
                return '<td style="background: #ecf0f1; color: #999; font-weight: var(--font-weight-semibold); font-size: var(--font-xl);">-</td>';
            }
            
            // kbo-records.json에서 데이터 찾기
            if (recordsData && recordsData.totalData && recordsData.totalData[team1] && recordsData.totalData[team1][team2]) {
                const record = recordsData.totalData[team1][team2];
                
                const wins = record.wins || 0;
                const losses = record.losses || 0;
                const draws = record.draws || 0;
                
                const homeWins = record.homeWins || 0;
                const homeLosses = record.homeLosses || 0;
                const homeDraws = record.homeDraws || 0;
                
                const awayWins = record.awayWins || 0;
                const awayLosses = record.awayLosses || 0;
                const awayDraws = record.awayDraws || 0;
                
                // 승률 계산
                const totalGames = wins + losses;
                const winRate = totalGames > 0 ? wins / totalGames : 0;
                
                const homeGames = homeWins + homeLosses;
                const homeWinRate = homeGames > 0 ? homeWins / homeGames : 0;
                
                const awayGames = awayWins + awayLosses;
                const awayWinRate = awayGames > 0 ? awayWins / awayGames : 0;
                
                // 승률에 따른 배경색 설정
                let backgroundColor = colorScheme.default.bg;
                let textColor = colorScheme.default.color;
                
                if (winRate === 0.5 || (draws > 0 && totalGames > 0)) {
                    // 정확히 50% 동률 또는 무승부가 있는 경우 - 노란색 배경
                    backgroundColor = colorScheme.neutral.bgMedium;
                } else if (winRate > 0.6) {
                    backgroundColor = colorScheme.positive.bgStrong;
                } else if (winRate > 0.5) {
                    backgroundColor = colorScheme.positive.bgMedium;
                } else if (winRate < 0.4) {
                    backgroundColor = colorScheme.negative.bgStrong;
                } else if (winRate < 0.5) {
                    backgroundColor = colorScheme.negative.bgMedium;
                }

                return `<td style="background: ${backgroundColor}; color: ${textColor}; padding: 8px;">
                    <div style="font-size: var(--font-base); line-height: 1.3; text-align: center;">
                        <div style="font-weight: var(--font-weight-semibold); margin-bottom: 2px;">${wins}-${losses}-${draws} (${winRate.toFixed(3)})</div>
                        <div style="font-size: var(--font-sm); color: ${textColor}; margin-bottom: 1px;">🏠 ${homeWins}-${homeLosses}-${homeDraws} (${homeWinRate.toFixed(3)})</div>
                        <div style="font-size: var(--font-sm); color: ${textColor};">✈️ ${awayWins}-${awayLosses}-${awayDraws} (${awayWinRate.toFixed(3)})</div>
                    </div>
                </td>`;
            } else {
                return '<td style="color: #999; font-weight: var(--font-weight-medium);">0승 0패<br><span style="font-size: var(--font-2xs);">(0.000)</span></td>';
            }
        }

        // 잔여경기수 셀 렌더링 함수
        function renderRemainingGamesCell(team1, team2, recordsData) {
            if (team1 === team2) {
                return '<td style="background: #ecf0f1; color: #999; font-weight: var(--font-weight-semibold); font-size: var(--font-xl);">-</td>';
            }
            
            // recordsData가 있고 데이터가 있는 경우 (totalData 객체 확인)
            const data = recordsData?.totalData || recordsData;
            
            // 디버깅용 로그 (첫 번째 호출 시만)
            if (team1 === 'LG' && team2 === '한화') {
                console.log('잔여경기수 계산 - recordsData:', recordsData);
                console.log('잔여경기수 계산 - data:', data);
                console.log('잔여경기수 계산 - team1 data:', data?.[team1]);
            }
            
            if (data && data[team1] && data[team1][team2]) {
                const record = data[team1][team2];
                const wins = parseInt(record.wins) || 0;
                const losses = parseInt(record.losses) || 0;
                const draws = parseInt(record.draws) || 0;
                
                const playedGames = wins + losses + draws;
                const totalGamesPerOpponent = 16; // KBO 정규시즌 팀당 16경기
                const remainingGames = Math.max(0, totalGamesPerOpponent - playedGames);
                
                // 색상 설정
                let backgroundColor;
                let textColor = '#333';
                
                if (remainingGames === 0) {
                    backgroundColor = 'rgba(156, 163, 175, 0.6)'; // 회색 - 경기 종료
                    textColor = '#666';
                } else if (remainingGames <= 3) {
                    backgroundColor = 'rgba(249, 115, 22, 0.6)'; // 주황색 - 적은 경기 남음
                } else if (remainingGames <= 6) {
                    backgroundColor = 'rgba(234, 179, 8, 0.6)'; // 노란색 - 보통
                } else {
                    backgroundColor = 'rgba(34, 197, 94, 0.6)'; // 초록색 - 많은 경기 남음
                }
                
                return `<td style="background: ${backgroundColor}; color: ${textColor}; font-weight: var(--font-weight-semibold); font-size: var(--font-md); text-align: center;">${remainingGames}</td>`;
            }
            
            // 데이터가 없는 경우
            return '<td style="background: #f8f9fa; color: #999; text-align: center;">-</td>';
        }
        
        // 월별 성적 전체 분석 (행/열 반전)
        function renderMonthlyFullAnalysis() {
            const thead = document.getElementById('monthlyTableHead');
            const tbody = document.getElementById('monthlyBody');
            thead.innerHTML = '';
            tbody.innerHTML = '';
            
            // 순위 순서대로 팀 정렬
            const rankedTeams = dashboardData.standings.map(team => team.team_name);
            
            // 헤더 생성: 월 + 각 팀 (로고와 함께) - 승패와 승률 분리
            const headerRow1 = document.createElement('tr');
            const headerRow2 = document.createElement('tr');
            
            headerRow1.innerHTML = `
                <th rowspan="2" style="min-width: 50px; vertical-align: middle; font-size: var(--font-base); white-space: nowrap;">월</th>
                ${rankedTeams.map(team => `<th colspan="2" style="min-width: 100px; font-size: var(--font-sm); white-space: nowrap; padding: 6px 2px;">${getTeamWithLogo(team, 'team-logo-small')}</th>`).join('')}
            `;
            
            headerRow2.innerHTML = `
                ${rankedTeams.map(team => `<th style="min-width: 45px; font-size: var(--font-sm); white-space: nowrap; padding: 4px 2px;">성적</th><th style="min-width: 40px; font-size: var(--font-sm); white-space: nowrap; padding: 4px 2px;">승률</th>`).join('')}
            `;
            
            thead.appendChild(headerRow1);
            thead.appendChild(headerRow2);
            
            // 월별 데이터 (3월~8월)
            const months = [3, 4, 5, 6, 7, 8];
            const monthNames = ['3월', '4월', '5월', '6월', '7월', '8월'];
            
            // 먼저 팀별 데이터를 미리 계산 (최고월/최저월 판단용)
            const teamStats = {};
            rankedTeams.forEach(team => {
                const monthlyData = dashboardData.monthlyPerformance[team];
                const validMonths = monthlyData.filter(month => month.wins + month.losses > 0);
                
                if (validMonths.length > 0) {
                    const teamRates = validMonths.map(month => ({
                        rate: parseFloat(month.win_rate),
                        month: month.month,
                        record: `${month.wins}-${month.losses}${month.draws ? '-' + month.draws : ''}`,
                        wins: month.wins,
                        losses: month.losses,
                        draws: month.draws || 0
                    }));
                    
                    const bestMonth = teamRates.reduce((best, current) => current.rate > best.rate ? current : best);
                    const worstMonth = teamRates.reduce((worst, current) => current.rate < worst.rate ? current : worst);
                    
                    teamStats[team] = {
                        bestMonth: bestMonth,
                        worstMonth: worstMonth
                    };
                }
            });

            months.forEach((monthNum, index) => {
                const row = document.createElement('tr');
                let html = `<td class="month-label"><strong>${monthNames[index]}</strong></td>`;
                
                let monthRates = []; // 해당 월의 모든 팀 승률
                
                // 각 팀의 해당 월 데이터 - 승패와 승률 분리
                rankedTeams.forEach(team => {
                    const monthlyData = dashboardData.monthlyPerformance[team];
                    const monthData = monthlyData?.find(month => month.month === monthNum);
                    
                    if (monthData && monthData.wins + monthData.losses > 0) {
                        const winRate = parseFloat(monthData.win_rate);
                        monthRates.push(winRate);
                        const winRateClass = getWinRateClass(winRate);
                        
                        const record = `${monthData.wins}-${monthData.losses}-${monthData.draws || 0}`;
                        
                        // 최고월/최저월 확인
                        const isBestMonth = teamStats[team] && teamStats[team].bestMonth.month === monthNum;
                        const isWorstMonth = teamStats[team] && teamStats[team].worstMonth.month === monthNum;
                        
                        // 다른 테이블과 동일한 색상 스타일 적용
                        let backgroundColor = colorScheme.default.bg;
                        let textColor = colorScheme.default.color;
                        
                        if (winRate === 0.5 || (monthData.draws && monthData.draws > 0)) {
                            // 정확히 50% 동률 또는 무승부가 있는 경우 - 노란색 배경
                            backgroundColor = colorScheme.neutral.bgMedium;
                        } else if (isBestMonth) {
                            backgroundColor = colorScheme.positive.bgStrong; // 최고월 - 연한 초록
                        } else if (isWorstMonth) {
                            backgroundColor = colorScheme.negative.bgStrong;  // 최저월 - 연한 빨강
                        } else if (winRate > 0.6) {
                            backgroundColor = colorScheme.positive.bgMedium;
                        } else if (winRate > 0.5) {
                            backgroundColor = colorScheme.positive.bgLight;
                        } else if (winRate < 0.4) {
                            backgroundColor = colorScheme.negative.bgMedium;
                        } else if (winRate < 0.5) {
                            backgroundColor = colorScheme.negative.bgLight;
                        }
                        
                        const cellStyle = `background: ${backgroundColor}; padding: 8px;`;
                        
                        // 승률에 따른 클래스 결정
                        const monthWinRateClass = getWinRateClass(winRate);
                        
                        html += `
                            <td class="month-record-cell ${monthWinRateClass}" style="${cellStyle} white-space: nowrap; font-size: var(--font-xs); padding: 6px 2px; text-align: center;">${record}</td>
                            <td class="month-rate-cell ${monthWinRateClass}" style="${cellStyle} white-space: nowrap; font-size: var(--font-xs); padding: 6px 2px; text-align: center;">${winRate.toFixed(3)}</td>
                        `;
                    } else {
                        html += '<td class="month-data" style="background: #f8f9fa; color: #999; padding: 6px 2px; white-space: nowrap; font-size: var(--font-xs); text-align: center;">-</td><td class="month-data" style="background: #f8f9fa; color: #999; padding: 6px 2px; white-space: nowrap; font-size: var(--font-xs); text-align: center;">-</td>';
                    }
                });
                
                
                row.innerHTML = html;
                tbody.appendChild(row);
            });
            
            // 평균 승률 계산 추가
            rankedTeams.forEach(team => {
                if (teamStats[team]) {
                    const monthlyData = dashboardData.monthlyPerformance[team];
                    const validMonths = monthlyData.filter(month => month.wins + month.losses > 0);
                    const teamRates = validMonths.map(month => parseFloat(month.win_rate));
                    const teamAverage = (teamRates.reduce((a, b) => a + b, 0) / teamRates.length);
                    teamStats[team].average = teamAverage.toFixed(3);
                    teamStats[team].averageNum = teamAverage; // 비교용 숫자값
                }
            });
            
            // 전체 평균 계산
            let allRates = [];
            rankedTeams.forEach(team => {
                const monthlyData = dashboardData.monthlyPerformance[team];
                monthlyData.forEach(month => {
                    if (month.wins + month.losses > 0) {
                        allRates.push(parseFloat(month.win_rate));
                    }
                });
            });
            const totalAverage = allRates.length > 0 ? 
                (allRates.reduce((a, b) => a + b, 0) / allRates.length).toFixed(3) : '-';

            // 1. 팀별 평균 승률 행
            const avgRow = document.createElement('tr');
            avgRow.className = 'stats-row';
            let avgHtml = `<td class="stats-label" style="background: #6b7280; color: white; border: 1px solid #4b5563; white-space: nowrap; font-size: var(--font-sm); padding: 6px 4px;"><strong>평균</strong></td>`;
            
            rankedTeams.forEach(team => {
                if (teamStats[team]) {
                    const avgClass = teamStats[team].averageNum > 0.55 ? 'positive' : 
                                   teamStats[team].averageNum < 0.45 ? 'negative' : 'neutral';
                    avgHtml += `<td colspan="2" class="${avgClass}" style="background: rgba(107, 114, 128, 0.1); text-align: center; border: 1px solid #d1d5db; white-space: nowrap; font-size: var(--font-sm); padding: 6px 2px;"><strong>${teamStats[team].average}</strong></td>`;
                } else {
                    avgHtml += '<td colspan="2" style="background: rgba(107, 114, 128, 0.1); color: #999; text-align: center; border: 1px solid #d1d5db; white-space: nowrap; font-size: var(--font-sm); padding: 6px 2px;">-</td>';
                }
            });
            avgRow.innerHTML = avgHtml;
            tbody.appendChild(avgRow);

            // 월별 테이블 정렬 기능 초기화
            const monthlyTable = document.getElementById('monthlyTable');
            makeTableSortable('monthlyTable');

        }

        // 요일별 성적 전체 분석
        function renderWeekdayFullAnalysis() {
            console.log('🔍 renderWeekdayFullAnalysis 호출됨');
            const tbody = document.getElementById('weekdayBody');
            console.log('weekdayBody 요소:', tbody);
            
            if (!tbody) {
                console.error('❌ weekdayBody 요소를 찾을 수 없습니다');
                return;
            }
            
            if (!dashboardData || !dashboardData.standings) {
                console.error('❌ dashboardData.standings가 없습니다');
                return;
            }
            
            const days = ['월', '화', '수', '목', '금', '토', '일'];
            
            // 순위 순서대로 팀 정렬
            const rankedTeams = dashboardData.standings.map(team => team.team_name);
            console.log('rankedTeams:', rankedTeams);
            
            let html = '';
            
            rankedTeams.forEach(team => {
                const weekdayData = dashboardData.weekdayPerformance[team];
                const rank = dashboardData.standings.find(t => t.team_name === team).rank;
                
                html += `<tr>
                    <td><strong>${rank}</strong></td>
                    <td class="team-name"><strong>${getTeamWithLogo(team, 'team-logo-small')}</strong></td>
                `;
                
                // 각 요일별 데이터
                days.forEach(day => {
                    if (weekdayData && weekdayData[day]) {
                        const winRateValue = parseFloat(weekdayData[day].win_rate);
                        const normalizedWinRate = winRateValue > 1 ? winRateValue / 100 : winRateValue;
                        const winRate = normalizedWinRate.toFixed(3);
                        
                        // 다른 테이블과 동일한 색상 적용
                        let backgroundColor = colorScheme.default.bg;
                        let textColor = colorScheme.default.color;
                        
                        if (normalizedWinRate === 0.5 || (weekdayData[day].draws && weekdayData[day].draws > 0)) {
                            // 정확히 50% 동률 또는 무승부가 있는 경우 - 노란색 배경
                            backgroundColor = colorScheme.neutral.bgMedium;
                        } else if (normalizedWinRate > 0.6) {
                            backgroundColor = colorScheme.positive.bgStrong;
                        } else if (normalizedWinRate > 0.5) {
                            backgroundColor = colorScheme.positive.bgMedium;
                        } else if (normalizedWinRate < 0.4) {
                            backgroundColor = colorScheme.negative.bgStrong;
                        } else if (normalizedWinRate < 0.5) {
                            backgroundColor = colorScheme.negative.bgMedium;
                        } else {
                            backgroundColor = colorScheme.neutral.bgLight;
                        }
                        
                        // 승률에 따른 클래스 결정
                        const dayWinRateClass = getWinRateClass(normalizedWinRate);
                        
                        const totalGames = weekdayData[day].wins + weekdayData[day].losses + (weekdayData[day].draws || 0);
                        html += `<td class="${dayWinRateClass}" style="background: ${backgroundColor}; font-size: var(--font-sm); padding: 8px; line-height: 1.3;">
                            <div style="font-weight: var(--font-weight-semibold); margin-bottom: 1px;">${weekdayData[day].wins}-${weekdayData[day].losses}-${weekdayData[day].draws || 0} (${winRate})</div>
                            <div style="font-size: var(--font-xs); margin-top: 2px;">${totalGames}경기</div>
                        </td>`;
                    } else {
                        html += `<td style="background: #f8f9fa; color: #999; font-size: var(--font-base); padding: 8px;">0-0-0 (0.000)</td>`;
                    }
                });
                
                // 주말승률 (토요일, 일요일)
                let weekendWins = 0, weekendLosses = 0;
                ['토', '일'].forEach(day => {
                    if (weekdayData && weekdayData[day]) {
                        weekendWins += weekdayData[day].wins;
                        weekendLosses += weekdayData[day].losses;
                    }
                });
                const weekendWinRate = (weekendWins + weekendLosses > 0) ? (weekendWins / (weekendWins + weekendLosses)) : 0;
                const weekendRate = weekendWinRate.toFixed(3);
                
                // 주말승률 색상
                let weekendBgColor = colorScheme.default.bg;
                if (weekendWinRate > 0.6) {
                    weekendBgColor = colorScheme.positive.bgStrong;
                } else if (weekendWinRate > 0.5) {
                    weekendBgColor = colorScheme.positive.bgMedium;
                } else if (weekendWinRate < 0.4) {
                    weekendBgColor = colorScheme.negative.bgStrong;
                } else if (weekendWinRate < 0.5) {
                    weekendBgColor = colorScheme.negative.bgMedium;
                } else {
                    weekendBgColor = colorScheme.neutral.bgLight;
                }
                
                // 평일승률 (월~금)
                let weekdayWins = 0, weekdayLosses = 0;
                ['월', '화', '수', '목', '금'].forEach(day => {
                    if (weekdayData && weekdayData[day]) {
                        weekdayWins += weekdayData[day].wins;
                        weekdayLosses += weekdayData[day].losses;
                    }
                });
                const weekdayWinRate = (weekdayWins + weekdayLosses > 0) ? (weekdayWins / (weekdayWins + weekdayLosses)) : 0;
                const weekdayRate = weekdayWinRate.toFixed(3);
                
                // 평일승률 색상
                let weekdayBgColor = colorScheme.default.bg;
                if (weekdayWinRate > 0.6) {
                    weekdayBgColor = colorScheme.positive.bgStrong;
                } else if (weekdayWinRate > 0.5) {
                    weekdayBgColor = colorScheme.positive.bgMedium;
                } else if (weekdayWinRate < 0.4) {
                    weekdayBgColor = colorScheme.negative.bgStrong;
                } else if (weekdayWinRate < 0.5) {
                    weekdayBgColor = colorScheme.negative.bgMedium;
                } else {
                    weekdayBgColor = colorScheme.neutral.bgLight;
                }
                
                // 주말/평일 승률에 따른 클래스 결정
                const weekendWinRateClass = getWinRateClass(weekendWinRate);
                const weekdayWinRateClass = getWinRateClass(weekdayWinRate);
                
                html += `
                    <td class="${weekendWinRateClass}" style="background: ${weekendBgColor}; font-size: var(--font-sm); padding: 8px; line-height: 1.3;">
                        <div style="font-weight: var(--font-weight-semibold); margin-bottom: 1px;">${weekendWins}-${weekendLosses} (${weekendRate})</div>
                        <div style="font-size: var(--font-xs); margin-top: 2px;">${weekendWins + weekendLosses}경기</div>
                    </td>
                    <td class="${weekdayWinRateClass}" style="background: ${weekdayBgColor}; font-size: var(--font-sm); padding: 8px; line-height: 1.3;">
                        <div style="font-weight: var(--font-weight-semibold); margin-bottom: 1px;">${weekdayWins}-${weekdayLosses} (${weekdayRate})</div>
                        <div style="font-size: var(--font-xs); margin-top: 2px;">${weekdayWins + weekdayLosses}경기</div>
                    </td>
                </tr>`;
            });
            
            console.log('생성된 HTML 길이:', html.length);
            console.log('HTML 미리보기:', html.substring(0, 200) + '...');
            tbody.innerHTML = html;
            console.log('✅ renderWeekdayFullAnalysis 완료');
        }

        // 경기장별 성적 표 분석
        function renderStadiumFullAnalysis() {
            console.log('🔍 renderStadiumFullAnalysis 호출됨');
            const thead = document.getElementById('stadiumTableHead');
            const tbody = document.getElementById('stadiumTableBody');
            console.log('stadiumTableHead:', thead, 'stadiumTableBody:', tbody);
            
            if (!thead || !tbody) {
                console.error('❌ stadiumTableHead 또는 stadiumTableBody 요소를 찾을 수 없습니다');
                return;
            }
            
            if (!dashboardData || !dashboardData.standings) {
                console.error('❌ dashboardData.standings가 없습니다');
                return;
            }
            
            // 순위 순으로 팀 정렬
            const rankedTeams = dashboardData.standings.map(team => team.team_name);
            console.log('rankedTeams:', rankedTeams);
            
            // 헤더 생성 (순위 순으로 팀명과 로고)
            let headerHtml = '<tr><th style="min-width: 140px; padding: 6px 8px; white-space: nowrap;">경기장</th>';
            rankedTeams.forEach(team => {
                headerHtml += `<th style="min-width: 80px; padding: 6px 4px; font-size: var(--font-sm); white-space: nowrap;"><strong>${getTeamWithLogo(team, 'team-logo-small')}</strong></th>`;
            });
            headerHtml += '</tr>';
            thead.innerHTML = headerHtml;
            
            // 모든 경기장 수집
            const stadiums = new Set();
            rankedTeams.forEach(team => {
                const stadiumData = dashboardData.stadiumRecords[team];
                if (stadiumData) {
                    stadiumData.forEach(record => stadiums.add(record.stadium));
                }
            });
            
            const stadiumList = Array.from(stadiums).sort();
            let html = '';
            
            stadiumList.forEach(stadium => {
                // 경기장 이름 단순화
                let stadiumName = stadium;
                if (stadium.includes('서울')) {
                    stadiumName = stadium.includes('잠실') ? '서울 잠실야구장' : '서울 고척스카이돔';
                } else {
                    const parts = stadium.split(' ');
                    stadiumName = parts[0] + ' ' + parts[1];
                }
                
                // 홈팀 확인
                const homeTeam = 
                    stadium.includes('광주') ? 'KIA' :
                    stadium.includes('잠실') ? 'LG/두산' :
                    stadium.includes('대구') ? '삼성' :
                    stadium.includes('인천') ? 'SSG' :
                    stadium.includes('수원') ? 'KT' :
                    stadium.includes('창원') ? 'NC' :
                    stadium.includes('부산') ? '롯데' :
                    stadium.includes('대전') ? '한화' :
                    stadium.includes('고척') ? '키움' : '';
                
                html += `<tr>
                    <td style="padding: 8px 12px; min-width: 180px;">
                        <div style="font-weight: var(--font-weight-semibold); font-size: var(--font-base); margin-bottom: 1px; white-space: nowrap;">${stadiumName}</div>
                        <div style="font-size: var(--font-sm); color: #666;">🏠 ${homeTeam}</div>
                    </td>
                `;
                
                // 각 팀별 해당 경기장 성적 (순위순)
                rankedTeams.forEach(team => {
                    const stadiumData = dashboardData.stadiumRecords[team];
                    const teamRecord = stadiumData ? stadiumData.find(r => r.stadium === stadium) : null;
                    
                    if (teamRecord) {
                        const winRateValue = parseFloat(teamRecord.win_rate);
                        const normalizedWinRate = winRateValue > 1 ? winRateValue / 100 : winRateValue;
                        const winRate = normalizedWinRate.toFixed(3);
                        const totalGames = teamRecord.wins + teamRecord.losses + (teamRecord.draws || 0);
                        
                        // 홈팀인지 확인
                        const isHome = 
                            (team === 'KIA' && stadium.includes('광주')) ||
                            ((team === 'LG' || team === '두산') && stadium.includes('잠실')) ||
                            (team === '삼성' && stadium.includes('대구')) ||
                            (team === 'SSG' && stadium.includes('인천')) ||
                            (team === 'KT' && stadium.includes('수원')) ||
                            (team === 'NC' && stadium.includes('창원')) ||
                            (team === '롯데' && stadium.includes('부산')) ||
                            (team === '한화' && stadium.includes('대전')) ||
                            (team === '키움' && stadium.includes('고척'));
                        
                        // 홈경기는 성적에 따른 배경색 + 파란색 폰트
                        let backgroundColor = colorScheme.default.bg;
                        let textColor = colorScheme.default.color;
                        let recordColor = colorScheme.default.color;
                        
                        // 성적에 따른 배경색 먼저 결정
                        if (normalizedWinRate === 0.5 || (teamRecord.draws && teamRecord.draws > 0)) {
                            // 정확히 50% 동률 또는 무승부가 있는 경우 - 노란색 배경
                            backgroundColor = colorScheme.neutral.bgMedium;
                            recordColor = colorScheme.neutral.color;
                        } else if (normalizedWinRate > 0.6) {
                            backgroundColor = colorScheme.positive.bgStrong;
                            recordColor = colorScheme.positive.color;
                        } else if (normalizedWinRate > 0.5) {
                            backgroundColor = colorScheme.positive.bgMedium;
                            recordColor = colorScheme.positive.color;
                        } else if (normalizedWinRate < 0.4) {
                            backgroundColor = colorScheme.negative.bgStrong;
                            recordColor = colorScheme.negative.color;
                        } else if (normalizedWinRate < 0.5) {
                            backgroundColor = colorScheme.negative.bgMedium;
                            recordColor = colorScheme.negative.color;
                        }
                        
                        // 홈팀이면 폰트만 파란색으로 변경
                        if (isHome) {
                            recordColor = '#1d4ed8'; // 파란색 텍스트
                        }
                        
                        html += `<td style="background: ${backgroundColor}; color: ${textColor}; padding: 6px 4px; white-space: nowrap; min-width: 80px;">
                            <div style="font-size: var(--font-sm); line-height: 1.2; text-align: center;">
                                <div style="font-weight: var(--font-weight-semibold); margin-bottom: 1px; color: ${recordColor}; white-space: nowrap;">${teamRecord.wins}-${teamRecord.losses}-${teamRecord.draws || 0}</div>
                                <div style="font-size: var(--font-xs); color: ${recordColor}; white-space: nowrap;">(${winRate})</div>
                                <div style="font-size: var(--font-xs); color: ${textColor}; margin-top: 1px; white-space: nowrap;">${isHome ? '🏠 ' : ''}${totalGames}경기</div>
                            </div>
                        </td>`;
                    } else {
                        html += `<td style="background: #f8f9fa; color: #999; padding: 6px 4px; white-space: nowrap; min-width: 80px;">
                            <div style="font-size: var(--font-sm); line-height: 1.2; text-align: center;">
                                <div style="font-weight: var(--font-weight-semibold); white-space: nowrap;">-</div>
                                <div style="font-size: var(--font-xs); white-space: nowrap;">&nbsp;</div>
                            </div>
                        </td>`;
                    }
                });
                
                html += '</tr>';
            });
            
            console.log('경기장별 헤더 HTML:', headerHtml.substring(0, 100));
            console.log('경기장별 바디 HTML 길이:', html.length);
            console.log('경기장별 HTML 미리보기:', html.substring(0, 200) + '...');
            tbody.innerHTML = html;
            console.log('✅ renderStadiumFullAnalysis 완료');
        }

        // 테이블 정렬 기능
        function makeTableSortable(tableId) {
            const table = document.getElementById(tableId);
            if (!table) return;
            
            const headers = table.querySelectorAll('th');
            headers.forEach((header, index) => {
                // no-sort 클래스가 있는 헤더는 일반 정렬에서 제외
                if (!header.classList.contains('no-sort')) {
                    header.classList.add('sortable');
                    header.addEventListener('click', () => {
                        sortTable(table, index, header);
                    });
                }
            });
        }
        
        function sortTable(table, columnIndex, header) {
            const tbody = table.querySelector('tbody');
            const allRows = Array.from(tbody.querySelectorAll('tr'));
            
            // 일반 데이터 행과 통계 행(월평균 등) 분리
            const dataRows = allRows.filter(row => !row.classList.contains('stats-row'));
            const statsRows = allRows.filter(row => row.classList.contains('stats-row'));
            
            // 현재 정렬 상태 확인
            const currentSort = header.classList.contains('sort-asc') ? 'asc' : 
                               header.classList.contains('sort-desc') ? 'desc' : 'none';
            
            // 모든 헤더의 정렬 클래스 제거
            table.querySelectorAll('th').forEach(h => {
                h.classList.remove('sort-asc', 'sort-desc');
            });
            
            // 다음 정렬 방향 결정
            const nextSort = currentSort === 'none' ? 'desc' : 
                            currentSort === 'desc' ? 'asc' : 'desc';
            
            // 일반 데이터 행만 정렬
            dataRows.sort((a, b) => {
                const aCell = a.cells[columnIndex];
                const bCell = b.cells[columnIndex];
                
                // 텍스트 추출 (HTML 태그 제거)
                let aValue = aCell.textContent || aCell.innerText;
                let bValue = bCell.textContent || bCell.innerText;
                
                // 숫자인지 확인 (승률, 득점 등)
                const aNum = parseFloat(aValue.replace(/[^\d.-]/g, ''));
                const bNum = parseFloat(bValue.replace(/[^\d.-]/g, ''));
                
                if (!isNaN(aNum) && !isNaN(bNum)) {
                    return nextSort === 'asc' ? aNum - bNum : bNum - aNum;
                }
                
                // 승-패 기록 정렬 (승수 기준)
                if (aValue.includes('-') && bValue.includes('-')) {
                    const aWins = parseInt(aValue.split('-')[0]);
                    const bWins = parseInt(bValue.split('-')[0]);
                    if (!isNaN(aWins) && !isNaN(bWins)) {
                        return nextSort === 'asc' ? aWins - bWins : bWins - aWins;
                    }
                }
                
                // 문자열 정렬
                return nextSort === 'asc' ? aValue.localeCompare(bValue) : bValue.localeCompare(aValue);
            });
            
            // tbody 초기화 후 데이터 행들 먼저 추가
            tbody.innerHTML = '';
            dataRows.forEach(row => tbody.appendChild(row));
            
            // 통계 행들을 맨 마지막에 추가 (고정 위치)
            statsRows.forEach(row => tbody.appendChild(row));
            
            // 종합순위 테이블인 경우 순위 컬럼 색상 업데이트
            if (table.id === 'fullStandingsTable') {
                updateRankColors(tbody);
            }
            
            // 헤더에 정렬 상태 표시
            header.classList.add(nextSort === 'asc' ? 'sort-asc' : 'sort-desc');
        }
        
        // 순위 컬럼 색상 업데이트 함수
        function updateRankColors(tbody) {
            const dataRows = Array.from(tbody.querySelectorAll('tr')).filter(row => !row.classList.contains('stats-row'));
            
            dataRows.forEach(row => {
                const rankCell = row.cells[0]; // 첫 번째 셀이 순위 컬럼
                if (rankCell) {
                    // 기존 순위 클래스 제거
                    rankCell.classList.remove('rank-1', 'rank-2', 'rank-3');
                    
                    // 순위 값 추출
                    const rankText = rankCell.textContent || rankCell.innerText;
                    const rank = parseInt(rankText.trim());
                    
                    // 새로운 순위 클래스 적용
                    if (rank <= 3) {
                        rankCell.classList.add(`rank-${rank}`);
                    }
                }
            });
        }
        
        // 모든 테이블에 정렬 기능 적용
        function initializeTableSorting() {
            const tableIds = [
                'fullStandingsTable',
                'pythagoreanTable', 
                'clutchTable',
                'homeAwayTable',
                'monthlyTable',
                'weekdayTable',
                'stadiumTable'
            ];
            
            tableIds.forEach(id => makeTableSortable(id));
        }

        // 시리즈 분석 데이터 로드
        async function loadSeriesAnalysisData() {
            try {
                const response = await fetch('magic-number/data/series-analysis.json');
                const seriesData = await response.json();
                renderSeriesAnalysis(seriesData);
            } catch (error) {
                console.error('시리즈 분석 데이터 로드 실패:', error);
                document.getElementById('seriesAnalysisContent').innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #e74c3c;">
                        <p>시리즈 분석 데이터를 로드할 수 없습니다.</p>
                        <small>시리즈 분석 스크립트를 먼저 실행해주세요.</small>
                    </div>
                `;
            }
        }

        // 시리즈 분석 렌더링
        function renderSeriesAnalysis(seriesData) {
            const container = document.getElementById('seriesAnalysisContent');
            
            let html = `
                <div class="series-analysis-container">
                    <!-- 위닝/루징 시리즈 통계 -->
                    ${renderSeriesStatsTable(seriesData.teamStats)}
                </div>

                <style>
                .series-analysis-container {
                    margin: 0;
                }


                .series-stats-table {
                    width: 100%;
                    border-collapse: collapse;
                    margin-top: 0;
                    font-size: var(--font-sm);
                }

                .series-stats-table th {
                    padding: 8px 6px;
                    text-align: center;
                    border: 1px solid #d1d5db;
                    background: #34495e;
                    color: white;
                    font-weight: var(--font-weight-semibold);
                    font-size: var(--font-base);
                    font-family: var(--font-family-base);
                    white-space: nowrap;
                }
                .series-stats-table th.sortable {
                    cursor: pointer;
                    user-select: none;
                    transition: all 0.2s ease;
                }
                .series-stats-table th.sortable:hover {
                    background: #2c3e50;
                    transform: translateY(-1px);
                }

                .series-stats-table td {
                    padding: 8px 6px;
                    border: 1px solid #d1d5db;
                    white-space: nowrap;
                    vertical-align: middle;
                }

                .series-stats-table tbody tr:nth-child(even) {
                    background-color: #f9f9f9;
                }

                .series-stats-table tbody tr:hover {
                    background-color: #f0f8ff;
                }


                @media (max-width: 768px) {
                    .series-stats-table {
                        font-size: var(--font-2xs);
                    }
                    
                    .series-stats-table th,
                    .series-stats-table td {
                        padding: 6px 4px;
                    }
                }
                </style>
            `;

            container.innerHTML = html;
            
            // 시리즈 분석 테이블 정렬 기능 초기화
            setTimeout(() => {
                makeTableSortable('seriesStatsTable');
            }, 100);
        }

        // 시리즈 통계 테이블 렌더링
        function renderSeriesStatsTable(teamStats) {
            const teams = Object.keys(teamStats).sort((a, b) => {
                const aRate = parseFloat(teamStats[a].seriesWinRate) / 100;
                const bRate = parseFloat(teamStats[b].seriesWinRate) / 100;
                return bRate - aRate;
            });

            let html = `

                <div class="table-container">
                    <table class="series-stats-table sortable-table" id="seriesStatsTable">
                        <thead>
                            <tr>
                                <th class="sortable" data-column="rank">순위</th>
                                <th class="sortable" data-column="team">팀명</th>
                                <th class="sortable" data-column="totalSeries">시리즈</th>
                                <th class="sortable" data-column="seriesWins">위닝</th>
                                <th class="sortable" data-column="seriesLosses">루징</th>
                                <th class="sortable" data-column="seriesDraws">무</th>
                                <th class="sortable" data-column="seriesWinRate">승률</th>
                                <th class="sortable" data-column="sweepWins">스윕승</th>
                                <th class="sortable" data-column="sweepLosses">스윕패</th>
                                <th class="sortable" data-column="currentStreak">연속기록</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            teams.forEach((team, index) => {
                const stats = teamStats[team];
                
                let streakText = '없음';
                let streakClass = 'neutral';
                if (stats.currentStreak.count > 0) {
                    if (stats.currentStreak.type === 'WIN') {
                        streakText = `${stats.currentStreak.count}연속 위닝시리즈`;
                        streakClass = 'positive';
                    } else if (stats.currentStreak.type === 'LOSS') {
                        streakText = `${stats.currentStreak.count}연속 루징시리즈`;
                        streakClass = 'negative';
                    } else {
                        streakText = `${stats.currentStreak.count}연속 드로우시리즈`;
                        streakClass = 'neutral';
                    }
                }

                html += `
                    <tr data-rank="${index + 1}" 
                        data-team="${team}" 
                        data-totalseries="${stats.totalSeries}"
                        data-serieswins="${stats.winningSeries}"
                        data-serieslosses="${stats.losingSeries}"
                        data-seriesdraws="${stats.splitSeries}"
                        data-serieswinrate="${parseFloat(stats.seriesWinRate) / 100}"
                        data-sweepwins="${stats.sweepWins}"
                        data-sweeplosses="${stats.sweepLosses}"
                        data-currentstreak="${stats.currentStreak.count}">
                        <td style="text-align: center;"><strong>${index + 1}</strong></td>
                        <td>${getTeamWithLogo(team)}</td>
                        <td style="text-align: center;"><strong>${stats.totalSeries}</strong></td>
                        <td style="color: #4CAF50; font-weight: var(--font-weight-bold); text-align: center;">${stats.winningSeries}</td>
                        <td style="color: #F44336; font-weight: var(--font-weight-bold); text-align: center;">${stats.losingSeries}</td>
                        <td style="text-align: center;">${stats.splitSeries}</td>
                        <td style="text-align: center;"><strong>${(parseFloat(stats.seriesWinRate) / 100).toFixed(3)}</strong></td>
                        <td style="color: #4CAF50; font-weight: var(--font-weight-bold); text-align: center;">${stats.sweepWins}</td>
                        <td style="color: #F44336; font-weight: var(--font-weight-bold); text-align: center;">${stats.sweepLosses}</td>
                        <td class="${streakClass}" style="font-weight: var(--font-weight-bold); text-align: center;">${streakText}</td>
                    </tr>
                `;
            });

            html += `
                        </tbody>
                    </table>
                </div>
                
                <!-- 설명 섹션 -->
                <div style="margin-top: 15px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">
                    <div style="font-size: var(--font-base); font-weight: var(--font-weight-medium); margin-bottom: 8px; color: #495057;">⚔️ 시리즈 성적 설명</div>
                    <div style="font-size: var(--font-sm); color: #6c757d; line-height: 1.5;">
                        <div style="margin-bottom: 6px;"><strong>시리즈:</strong> 같은 상대팀과 연속으로 치르는 경기 묶음 (보통 2-4경기)</div>
                        <div style="margin-bottom: 6px;"><strong>위닝/루징 시리즈:</strong> 시리즈에서 승리/패배한 경우</div>
                        <div style="margin-bottom: 6px;"><strong>스윕승/스윕패:</strong> 시리즈에서 모든 경기를 완전히 승리/패배한 경우</div>
                        <div><strong>연속기록:</strong> 최근 시리즈에서의 위닝/루징 연속 횟수</div>
                    </div>
                </div>
                
                <style>
                .positive { color: #4CAF50; }
                .negative { color: #F44336; }
                .neutral { color: #666; }
                </style>
            `;

            return html;
        }

        // 시즌 진행률 업데이트 함수
        function updateSeasonProgress() {
            console.log('updateSeasonProgress 함수 호출됨');
            console.log('dashboardData:', dashboardData);
            
            if (!dashboardData || !dashboardData.standings) {
                console.log('dashboardData 또는 standings가 없음');
                return;
            }

            const teams = dashboardData.standings;
            let totalGamesPlayed = 0;
            const totalPossibleGames = 720; // 10팀이 서로 경기하는 총 경기 수 (1440÷2)
            const gamesPerTeam = 144;
            
            console.log('teams 배열:', teams);
            console.log('teams 길이:', teams?.length);
            
            // 팀별 색상 정의 (JSON의 team_name 기준)
            const teamColors = {
                'LG': '#C30452',
                'KIA': '#EA0029', 
                'SSG': '#CE0E2D',
                '삼성': '#1E22AA',
                '두산': '#131230',
                'KT': '#000000',
                'NC': '#315288',
                '롯데': '#041E42',
                '한화': '#FF6600',
                '키움': '#570D28'
            };
            
            // 팀명 매핑 (JSON 이름 → 전체 이름)
            const teamFullNames = {
                'LG': 'LG 트윈스',
                'KIA': 'KIA 타이거즈', 
                'SSG': 'SSG 랜더스',
                '삼성': '삼성 라이온즈',
                '두산': '두산 베어스',
                'KT': 'KT 위즈',
                'NC': 'NC 다이노스',
                '롯데': '롯데 자이언츠',
                '한화': '한화 이글스',
                '키움': '키움 히어로즈'
            };
            
            // 팀 로고 파일명 매핑 (JSON 이름 → 파일명)
            const teamLogoFiles = {
                'LG': 'lg',
                'KIA': 'kia', 
                'SSG': 'ssg',
                '삼성': 'samsung',
                '두산': 'doosan',
                'KT': 'kt',
                'NC': 'nc',
                '롯데': 'lotte',
                '한화': 'hanwha',
                '키움': 'kiwoom'
            };

            // 전체 경기 수 계산
            teams.forEach(team => {
                totalGamesPlayed += parseInt(team.games_played);
            });
            totalGamesPlayed = Math.floor(totalGamesPlayed / 2); // 각 경기가 두 팀에 계산되므로 나누기 2

            const overallProgress = Math.min((totalGamesPlayed / totalPossibleGames) * 100, 100);

            // 전체 진행률 업데이트
            setTimeout(() => {
                document.getElementById('overall-progress-bar').style.width = `${overallProgress}%`;
                document.getElementById('overall-progress-text').textContent = `${overallProgress.toFixed(1)}%`;
                document.getElementById('games-info').textContent = `${totalGamesPlayed}/${totalPossibleGames} 경기 완료`;
            }, 500);

            // 팀별 진행률 생성
            const teamProgressContainer = document.getElementById('team-progress-container');
            teamProgressContainer.innerHTML = '';

            teams.forEach((team, index) => {
                const gamesPlayed = parseInt(team.games_played);
                const progress = Math.min((gamesPlayed / gamesPerTeam) * 100, 100);
                const teamColor = teamColors[team.team_name] || '#6366f1';
                const fullTeamName = teamFullNames[team.team_name] || team.team_name;
                const logoFile = teamLogoFiles[team.team_name] || team.team_name.toLowerCase();

                const teamProgressItem = document.createElement('div');
                teamProgressItem.className = 'team-progress-item';
                teamProgressItem.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <img src="images/${logoFile}.png" 
                                 alt="${fullTeamName}" 
                                 style="width: 20px; height: 20px; object-fit: contain;"
                                 onerror="this.style.display='none';">
                            <span style="font-weight: 600; font-size: 0.95rem;">${fullTeamName}</span>
                        </div>
                        <span style="font-weight: 700; color: ${teamColor};">${progress.toFixed(1)}%</span>
                    </div>
                    <div class="team-progress-bar">
                        <div class="team-progress-fill" 
                             style="background: linear-gradient(90deg, ${teamColor}, ${teamColor}aa); width: 0%;">
                        </div>
                    </div>
                    <div style="display: flex; justify-content: space-between; font-size: 0.85rem; color: #6b7280;">
                        <span>${gamesPlayed}경기 완료</span>
                        <span>${gamesPerTeam - gamesPlayed}경기 남음</span>
                    </div>
                `;

                teamProgressContainer.appendChild(teamProgressItem);

                // 애니메이션 효과로 진행률 바 채우기
                setTimeout(() => {
                    teamProgressItem.querySelector('.team-progress-fill').style.width = `${progress}%`;
                }, 800 + (index * 100));
            });
        }






        // 페이지 로드 시 데이터 로드 및 정렬 기능 초기화
        window.addEventListener('DOMContentLoaded', () => {
            // 대시보드 데이터 로드
            loadDashboardData().then(() => {
                // 대시보드 로드 완료 후 정렬 기능 초기화
                setTimeout(() => {
                    initializeTableSorting();
                    updateSeasonProgress(); // 시즌 진행률 업데이트
                }, 100);
                
                // 추가로 조금 더 늦게 한번 더 호출
                setTimeout(() => {
                    updateSeasonProgress();
                }, 1000);
            }).catch(error => {
                console.error('대시보드 데이터 로드 실패:', error);
            });
            
            // 주차별/게임별/팀별 데이터 로드 (병렬)
            loadWeeklyAnalysisData().catch(error => {
                console.error('주차별 데이터 로드 실패:', error);
            });
            
            // 시리즈 분석 데이터 로드
            loadSeriesAnalysisData().catch(error => {
                console.error('시리즈 분석 데이터 로드 실패:', error);
            });
            
            // 네비게이션 활성 상태 관리
            initializeNavigation();
        });

        // 네비게이션 초기화 및 스크롤 감지
        function initializeNavigation() {
            const navItems = document.querySelectorAll('.nav-item');
            const sections = document.querySelectorAll('.card[id]');
            
            // 스크롤 이벤트 리스너
            let isScrolling = false;
            window.addEventListener('scroll', () => {
                if (!isScrolling) {
                    window.requestAnimationFrame(() => {
                        updateActiveNavItem();
                        isScrolling = false;
                    });
                    isScrolling = true;
                }
            });
            
            // 초기 활성 상태 설정
            updateActiveNavItem();
            
            // 네비게이션 클릭 이벤트
            navItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = item.getAttribute('href').substring(1);
                    const targetSection = document.getElementById(targetId);
                    
                    if (targetSection) {
                        // 네비게이션 바 높이만큼 오프셋 추가
                        const navHeight = document.querySelector('.navigation').offsetHeight;
                        const targetPosition = targetSection.offsetTop - navHeight - 20;
                        
                        window.scrollTo({
                            top: targetPosition,
                            behavior: 'smooth'
                        });
                    }
                });
            });
        }
        
        // 현재 보이는 섹션에 따라 네비게이션 활성 상태 업데이트
        function updateActiveNavItem() {
            const navItems = document.querySelectorAll('.nav-item');
            const sections = document.querySelectorAll('.card[id]');
            const scrollPosition = window.scrollY + window.innerHeight / 3;
            
            let activeSection = null;
            
            // 현재 스크롤 위치에서 가장 가까운 섹션 찾기
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionBottom = sectionTop + section.offsetHeight;
                
                if (scrollPosition >= sectionTop && scrollPosition <= sectionBottom) {
                    activeSection = section.id;
                }
            });
            
            // 페이지 상단에 있을 때는 첫 번째 섹션을 활성화
            if (window.scrollY < 100) {
                activeSection = 'season-progress';
            }
            
            // 네비게이션 아이템 활성 상태 업데이트
            navItems.forEach(item => {
                const targetId = item.getAttribute('href').substring(1);
                if (targetId === activeSection) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
        }
    </script>

        <!-- 쿠팡 광고 3: 개선 제안 카드 전 -->
        <div class="ad-card">
            <div style="font-size: 0.8rem; color: #666; margin-bottom: 10px;">광고</div>
            <script src="https://ads-partners.coupang.com/g.js"></script>
            <script>
                new PartnersCoupang.G({"id":867629,"trackingCode":"AF6959276","subId":null,"template":"carousel","width":"100%","height":"180"});
            </script>
        </div>

        <!-- 개선 제안 카드 -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">💡</span>
                <h2 class="card-title">개선 제안을 보내주세요</h2>
            </div>
            <div class="improvement-suggestion-content">
                <p class="improvement-suggestion-text">
                    더 나은 서비스를 위해 여러분의 의견이 필요합니다<br>
                    <span class="improvement-suggestion-subtext">회원가입 없이 간편하게 제출 가능합니다</span>
                </p>
                <a href="https://docs.google.com/forms/d/e/1FAIpQLSdsKAxcN6CuEf2f7WkEscHxdub20VlkaNTtis_okXUh-I4BTQ/viewform?usp=header" 
                   target="_blank" 
                   rel="noopener"
                   class="improvement-suggestion-btn">
                    📝 개선 제안 설문지 작성하기
                </a>
            </div>
        </div>

    </div>

    <!-- 푸터 섹션 -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>🤖 KBO 2025 종합 분석 대시보드</h3>
                <p>한국프로야구의 모든 데이터를 한눈에 분석하고 비교할 수 있는 종합 대시보드입니다.</p>
            </div>
            
            <div class="footer-section">
                <h4>KBO 팀 정보</h4>
                <div class="team-links">
                    <a href="https://www.hanwhaeagles.co.kr" target="_blank" rel="noopener" class="team-link-item">
                        <img src="images/hanwha.png" alt="한화 이글스" class="team-logo">
                        <span>한화 이글스</span>
                    </a>
                    <a href="https://www.lgtwins.com" target="_blank" rel="noopener" class="team-link-item">
                        <img src="images/lg.png" alt="LG 트윈스" class="team-logo">
                        <span>LG 트윈스</span>
                    </a>
                    <a href="https://www.giantsclub.com" target="_blank" rel="noopener" class="team-link-item">
                        <img src="images/lotte.png" alt="롯데 자이언츠" class="team-logo">
                        <span>롯데 자이언츠</span>
                    </a>
                    <a href="https://www.ssglanders.com" target="_blank" rel="noopener" class="team-link-item">
                        <img src="images/ssg.png" alt="SSG 랜더스" class="team-logo">
                        <span>SSG 랜더스</span>
                    </a>
                    <a href="https://www.ktwiz.co.kr" target="_blank" rel="noopener" class="team-link-item">
                        <img src="images/kt.png" alt="KT 위즈" class="team-logo">
                        <span>KT 위즈</span>
                    </a>
                    <a href="https://tigers.co.kr" target="_blank" rel="noopener" class="team-link-item">
                        <img src="images/kia.png" alt="KIA 타이거즈" class="team-logo">
                        <span>KIA 타이거즈</span>
                    </a>
                    <a href="https://www.samsunglions.com" target="_blank" rel="noopener" class="team-link-item">
                        <img src="images/samsung.png" alt="삼성 라이온즈" class="team-logo">
                        <span>삼성 라이온즈</span>
                    </a>
                    <a href="https://www.ncdinos.com" target="_blank" rel="noopener" class="team-link-item">
                        <img src="images/nc.png" alt="NC 다이노스" class="team-logo">
                        <span>NC 다이노스</span>
                    </a>
                    <a href="https://www.doosanbears.com" target="_blank" rel="noopener" class="team-link-item">
                        <img src="images/doosan.png" alt="두산 베어스" class="team-logo">
                        <span>두산 베어스</span>
                    </a>
                    <a href="https://www.heroesbaseball.co.kr" target="_blank" rel="noopener" class="team-link-item">
                        <img src="images/kiwoom.png" alt="키움 히어로즈" class="team-logo">
                        <span>키움 히어로즈</span>
                    </a>
                </div>
            </div>
            
            <div class="footer-section">
                <h4>KBO 공식 정보</h4>
                <ul class="footer-links">
                    <li><a href="https://www.koreabaseball.com" target="_blank" rel="noopener">KBO 공식 홈페이지</a></li>
                    <li><a href="https://www.koreabaseball.com/Schedule/Schedule.aspx" target="_blank" rel="noopener">경기 일정</a></li>
                    <li><a href="https://www.koreabaseball.com/Record/TeamRank/TeamRankDaily.aspx" target="_blank" rel="noopener">팀 순위</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h4>데이터 정보</h4>
                <p class="data-info">최종 업데이트: 2025년 8월 15일</p>
                <p class="data-source">데이터 출처: KBO 공식 기록</p>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>&copy; 2025 KBO 분석 대시보드. 모든 데이터는 KBO 공식 기록을 기반으로 합니다.</p>
        </div>
    </footer>

    <style>
        .footer {
            background: linear-gradient(135deg, #1a237e 0%, #3949ab 100%);
            color: #ffffff;
            margin-top: 50px;
            padding: 40px 20px 20px 20px;
            width: 100%;
            font-family: 'Noto Sans KR', sans-serif;
            box-sizing: border-box;
            box-shadow: 0 -4px 8px rgba(0,0,0,0.12);
        }

        .footer-content {
            max-width: 1600px;
            margin: 0 auto;
            padding: 0;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 30px;
        }

        @media (max-width: 1024px) {
            .footer-content {
                grid-template-columns: repeat(2, 1fr);
                gap: 25px;
            }
        }

        @media (max-width: 640px) {
            .footer-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
        }

        .footer-section h3 {
            color: #ffd700;
            font-size: var(--font-xl);
            margin-bottom: 15px;
            font-weight: var(--font-weight-semibold);
        }

        .footer-section h4 {
            color: #ffab91;
            font-size: var(--font-lg);
            margin-bottom: 12px;
            font-weight: var(--font-weight-medium);
        }

        .footer-section p {
            font-size: var(--font-sm);
            line-height: 1.6;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 10px;
        }

        .team-links {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 6px;
            justify-content: flex-start;
        }

        .team-link-item {
            display: flex;
            align-items: center;
            gap: 4px;
            color: rgba(255, 255, 255, 0.7);
            font-size: var(--font-xs);
            font-weight: 400;
            text-decoration: none;
            transition: color 0.3s ease;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .team-link-item:hover {
            color: #ffd700;
        }

        .team-logo {
            width: 14px;
            height: 14px;
            object-fit: contain;
            flex-shrink: 0;
        }

        .analysis-features {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 15px;
        }

        .feature-tag {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: #ffffff;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: var(--font-xs);
            font-weight: var(--font-weight-semibold);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .feature-tag:hover {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .footer-links {
            list-style: none;
            padding: 0;
        }

        .footer-links li {
            margin-bottom: 8px;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            font-size: var(--font-sm);
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: #ffd700;
        }

        .data-info, .data-source {
            font-size: var(--font-xs);
            color: rgba(255, 255, 255, 0.6);
        }

        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 30px;
            padding-top: 20px;
            text-align: center;
        }

        .footer-bottom p {
            font-size: var(--font-xs);
            color: rgba(255, 255, 255, 0.6);
            margin: 0;
        }

        @media (max-width: 768px) {
            .footer-content {
                grid-template-columns: 1fr;
                gap: 25px;
            }
            
            .team-links {
                justify-content: center;
            }
        }
    </style>
    <!-- 탑으로 가기 버튼 -->
    <button class="scroll-to-top" id="scrollToTop">↑</button>

    <script>
        // 탑으로 가기 버튼 기능 - magic-number 방식 적용
        document.addEventListener('DOMContentLoaded', function() {
            const scrollToTopButton = document.getElementById('scrollToTop');
            
            // 스크롤 이벤트 리스너
            window.addEventListener('scroll', function() {
                if (window.pageYOffset > 300) {
                    scrollToTopButton.classList.add('show');
                } else {
                    scrollToTopButton.classList.remove('show');
                }
            });
            
            // 버튼 클릭 이벤트
            scrollToTopButton.addEventListener('click', function() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
        });
    </script>

</body>
</html>